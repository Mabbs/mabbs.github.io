---
layout: post
title: Mayx的计算机学习史
tags: [Mayx, 计算机, 学习]
---

今天我想说说我学习计算机的过程。<!--more-->   

**注：由于记忆的不可靠性，我并不保证该文章的真实性    
虽然很想用时间轴来描述，但是我怎么可能清晰的记起时间点呢？（LOL）   
该文章有不少代码，可以使用目录来跳过**   

# 原始阶段
  我第一次接触计算机，貌似是因为PowerPoint。不过因为事情久远，我记得不是很清晰，只记得当时随便乱动PowerPoint 2003，发现了不少功能，然后做了第一个演示文稿，好像叫《我是人》？！   
  
# 混乱阶段
  从接触计算机后，我似乎经常性的破坏其他人的电脑，因为我以前喜欢动设置之类的东西，尤其是360，然后动着动着就动坏了……
  
# 编程阶段
## 编程初期
  最早接触的编程是LOGO(?)……太过久远我也想不起来了……我只记得最早接触的是BAT(Windows批处理脚本语言)，以前在电脑里发现了一款Ghost工具箱(?)的脚本，虽然当时并不会编程，不过靠自己对计算机语言的理解在瞎编，竟然可以运行。   
  后来加入了一个叫批处理之家的论坛，我叫做[111](http://www.bathome.net/space.php?uid=51236)（LOL真不敢相信这个论坛一直到今天还活着），在这里我学到了不少关于批处理的事情。   
  因为学批处理是基于某工具箱的，所以用批处理写的程序也是工具箱，就叫做批处理工具。以下是该程序的源代码：   

<script>
  function showcode() { 
  $('.showbutton').toggle();
  $('.language-code').toggle();
  }
</script>
<style>
.language-code{ display:none; }
.language-shell{ display:none; }
</style>
<button onclick="showcode()" class="showbutton">Show Code</button>
<button onclick="showcode()" class="showbutton" style="display:none;">Hide Code</button>

```code
@echo off
color f0
mode con cols=50 lines=10
echo.
echo 正在检查管理权限……
echo.>%windir%\cs.shs
cls
if not exist %windir%\cs.shs echo 请使用管理员权限启动本程序……&ping /n 2 127.1>nul&exit
del %windir%\cs.shs
echo.
echo 正在检查授权状态……
if exist %windir%\zcq.shs goto okzzzz
mode con cols=50 lines=10
title 构建安全环境
echo.
echo            准备构建安全环境避免病毒驻留
echo.
echo           即将自动关闭除系统外的所有进程
echo.
echo                请保存未完成的工作
echo.
echo                Y 开始  其他键跳过
set choose=~
set /p choose=请选择：
if /I %choose%==Y goto Build_safe2
goto Build_safe_jump2

:Build_safe2
cls
echo.
echo                     正在构建
echo.
echo                       稍后
cls
echo.
echo                  未授权，无法构建
ping /n 2 127.1>nul
goto _max2

:Build_safe_jump2
cls
echo.
echo.
echo.
echo                     放弃
ping /n 2 127.1>nul
goto _max2


:_max2
mode con: cols=60 lines=31
color f0
title 批处理工具(未授权)
setlocal enabledelayedexpansion

:_m2
cls
call :cdwjj
set chi=
set /p chi=  请选择操作后回车:
if '%chi%'=='' goto _m2
if /i '%chi%'=='help' goto help
if /i '%chi%'=='set' goto setvbs
if /i '%chi%'=='esc' exit
echo 未授权，无法使用
pause>nul
goto _m2

:help
cls
echo 帮助
echo 版权：▁▂▃▄▅▆▇█ dr.ma █▇▆▅▄▃▂▁
echo 请输入set获取正版软件……
echo 请按任意键返回
pause >nul
goto _m2

:setvbs
echo 注册
set pass=
set /p pass=请输入注册码：
if '%pass%'=='MYXNB-GMYXK-KT000-HAHA1-11110' echo.>%windir%\zcq.shs&goto okzzzz
goto setvbs

:okzzzz
echo ok！
if not '%1'=='' set chi=%1&goto ls
color f0
mode con cols=50 lines=10
title 构建安全环境
echo.
echo            准备构建安全环境避免病毒驻留
echo.
echo           即将自动关闭除系统外的所有进程
echo.
echo                请保存未完成的工作
echo.
echo                Y 开始  其他键跳过
set choose=~
set /p choose=请选择：
if /I %choose%==Y goto Build_safe
goto Build_safe_jump

:Build_safe
cls
echo.
echo                     正在构建
echo.
echo                       稍后
for /f "skip=5 tokens=1" %%t in ('tasklist^|findstr /v /i "cmd.exe svchost.exe lsass.exe services.exe winlogon.exe csrss.exe smss.exe csrss.exe"') do (
taskkill /f /im %%t>nul 2>nul
)
start explorer.exe>nul 2>nul
cls
echo.
echo                     构建完成
ping /n 2 127.1>nul
goto _max

:Build_safe_jump
cls
echo.
echo.
echo.
echo                     放弃
ping /n 2 127.1>nul
goto _max


:_max
mode con: cols=60 lines=31
color f0
title 批处理工具
setlocal enabledelayedexpansion

:_m1
cls
call :cdwjj
goto lz
:cdwjj
echo           现在时间：%date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒
echo                     ╔════════╗
if '%PROCESSOR_ARCHITECTURE%'=='x86' echo                     ║正在使用32位系统║
if '%PROCESSOR_ARCHITECTURE%'=='AMD64' echo                     ║正在使用64位系统║
echo                     ╚════════╝
echo                        ╔═════╗
echo                        ║批处理工具║
echo  ╔══════════╩══╦══╩══════════╗
echo  ║ 1、PPPoE连接             ║ 18、指针时钟             ║
echo  ║ 2、编辑boot.ini          ║ 19、测试身体质量指数     ║
echo  ║ 3、清除系统垃圾          ║ 20、批处理加密           ║
echo  ║ 4、winrar注册            ║ 21、定时提醒器           ║
echo  ║ 5、用户登录设置          ║ 22、显示网络配置         ║
echo  ║ 6、系统程序              ║ 23、列举进程             ║
echo  ║ 7、磁盘碎片整理          ║ 24、文件管理器           ║
echo  ║ 8、将磁盘转换成ntfs格式  ║ 25、关机类               ║
echo  ║ 9、修复磁盘              ║ 26、报时器               ║
echo  ║ 10、简易秒表             ║ 27、整点报时钟           ║
echo  ║ 11、整数计算器           ║ 28、日历时钟             ║
echo  ║ 12、液晶显示器坏点测试器 ║ 29、文件合并             ║
echo  ║ 13、电子钟表             ║ 30、ExtractMSI           ║
echo  ║ 14、百度搜索             ║ 31、自动设置IP           ║
echo  ║ 15、读中英文             ║ 32、注册表扫描           ║
echo  ║ 16、U盘修复              ║ 33、病毒免疫             ║
echo  ║ 17、自动计算24点         ║ 34、修复系统安全模式     ║
echo  ╠═══════╦═════╩════╦════════╣
if not exist %windir%\zcq.shs echo  ║   help、帮助 ║Esc、退出批处理工具 ║   set、注册    ║
if exist %windir%\zcq.shs echo  ║   help、帮助 ║Esc、退出批处理工具 ║ set、颜色设置  ║
echo  ╠═══════╩══════════╩════════╣
echo  ║                   next、下一页                       ║
echo  ╚═══════════════════════════╝
goto :eof
:lz
set chi=
set /p chi=  请选择操作后回车:
mode con: cols=60 lines=31
color %col%
if '%col%'=='' color f0
:ls
title 批处理工具
setlocal enabledelayedexpansion
if '%chi%'=='' goto _m1
if '%chi%'=='1' goto a
if '%chi%'=='2' start c:\boot.ini
if '%chi%'=='3' goto b
if '%chi%'=='4' goto c
if '%chi%'=='5' rundll32 netplwiz.dll,UsersRunDll
if '%chi%'=='6' goto Choice4
if '%chi%'=='7' goto def
if '%chi%'=='8' goto e
if '%chi%'=='9' goto d
if '%chi%'=='10' goto mb
if '%chi%'=='11' goto jsq
if '%chi%'=='12' goto yjxs
if '%chi%'=='13' goto dzzb
if '%chi%'=='14' goto bd
if '%chi%'=='15' goto dzy
if '%chi%'=='16' goto U_Repair
if '%chi%'=='17' goto 24d
if '%chi%'=='18' goto zzsz
if '%chi%'=='19' goto zlzs
if '%chi%'=='20' goto pcljm
if '%chi%'=='21' goto dstxq
if '%chi%'=='22' goto wlpz
if '%chi%'=='23' goto ljjc
if '%chi%'=='24' goto qlss
if '%chi%'=='25' goto shutdown
if '%chi%'=='26' goto bsqlg
if '%chi%'=='27' goto bszlgo
if '%chi%'=='28' goto rlszcd
if '%chi%'=='29' goto hbmp3zb
if '%chi%'=='30' goto hbbsbsb
if '%chi%'=='31' goto Zzdszip
if '%chi%'=='32' goto Registry_Scan
if '%chi%'=='33' goto Virus_Immune
if '%chi%'=='34' goto Repair_Safemode
if '%chi%'=='help' goto help
if '%chi%'=='/?' goto help
if '%chi%'=='set' goto set
if '%chi%'=='esc' exit
if '%chi%'=='next' goto _m3
if not "%chi%"=="" goto long
goto _m1

:set
echo 颜色属性由两个十六进制数字指定 -- 第一个为背景，第二
echo 个则为前景。每个数字可以为以下任何值之一:
echo.
echo     0 = 黑色       8 = 灰色
echo     1 = 蓝色       9 = 淡蓝色
echo     2 = 绿色       A = 淡绿色
echo     3 = 湖蓝色     B = 淡浅绿色
echo     4 = 红色       C = 淡红色
echo     5 = 紫色       D = 淡紫色
echo     6 = 黄色       E = 淡黄色
echo     7 = 白色       F = 亮白色
echo.
echo 如果没有给定任何参数，会将颜色还原到上次的颜色。
set /p col=请输入参数：
goto _m1

:help
cls
echo 命令行帮助
echo 格式：%0 [cmd] [/?]
echo 解释：
echo "cmd"
echo 便携打开操作
echo "/?"
echo 命令行帮助
echo ═════════════════════════════
echo 例：
echo c:\^>%0 3
echo 垃圾清理程序正在清理系统垃圾文件，请稍等......
echo.
echo ═════════════════════════════
echo 版权：▁▂▃▄▅▆▇█ dr.ma █▇▆▅▄▃▂▁
echo 请按任意键返回
pause >nul
goto _m1

:a
mode con: cols=30 lines=3
title PPPoE连接
set /p user=请输入宽带用户名：
set /p pass=请输入宽带密码：
set "NIC_flag=Ethernet"
for /f "tokens=1,2,3,* delims=: " %%i in ('ipconfig /all') do (
     if "%%i"=="%NIC_flag%"  set NIC_name=%%k)
rasdial %NIC_name% %user% %pass%
pause>nul
goto _max

:b
echo 批处理工具正在清理系统垃圾文件，请稍等......
del /f /s /q /a %systemdrive%\*.tmp>nul 2>nul
del /f /s /q /a %systemdrive%\*._mp>nul 2>nul
del /f /s /q /a %windir%\*.log>nul 2>nul
del /f /s /q /a %systemdrive%\*.gid>nul 2>nul
del /f /s /q /a %systemdrive%\*.chk>nul 2>nul
del /f /s /q /a %systemdrive%\*.old>nul 2>nul
del /f /s /q /a %systemdrive%\recycled\*.*>nul 2>nul
del /f /s /q /a %windir%\*.bak>nul 2>nul
del /f /s /q /a %windir%\prefetch\*.*>nul 2>nul
del /f /s /q /a %windir%\temp>nul 2>nul & md %windir%\temp\*.*>nul 2>nul
del /f /q %userprofile%\cookies\*.*>nul 2>nul
del /f /q %userprofile%\recent\*.*>nul 2>nul
del /f /s /q /a "%userprofile%\Local Settings\Temporary Internet Files\*.*">nul 2>nul
del /f /s /q /a "%userprofile%\Local Settings\Temp\*.*">nul 2>nul
del /f /s /q /a "%userprofile%\recent\*.*">nul 2>nul
dir %windir%\$Nt*$ /b/ad>c:\tmp.txt
if not exist c:\tmp.txt goto end

for /f %%v in ('findstr "KB Q" c:\tmp.txt') do (
 set tp=%%v
)
for /f %%i in ('dir %%windir%%\$*$ /b/ad') do rd %windir%\%%i /s/q>nul 2>nul

:end
if exist c:\tmp.txt del c:\tmp.txt>nul 2>nul
if exist c:\tmp.bat del c:\tmp.bat>nul 2>nul
if exist c:\tmp.reg reg c:\tmp.reg>nul 2>nul
echo 清理系统垃圾完成！
echo 请按任意键返回
pause >nul
goto _m1

:c
echo RAR registration data >"C:\Program Files\WinRAR\rarreg.key"
echo Federal Agency for Education >>"C:\Program Files\WinRAR\rarreg.key"
echo 1000000 PC usage license >>"C:\Program Files\WinRAR\rarreg.key"
echo UID=b621cca9a84bc5deffbf >>"C:\Program Files\WinRAR\rarreg.key"
echo 6412612250ffbf533df6db2dfe8ccc3aae5362c06d54762105357d >>"C:\Program Files\WinRAR\rarreg.key"
echo 5e3b1489e751c76bf6e0640001014be50a52303fed29664b074145 >>"C:\Program Files\WinRAR\rarreg.key"
echo 7e567d04159ad8defc3fb6edf32831fd1966f72c21c0c53c02fbbb >>"C:\Program Files\WinRAR\rarreg.key"
echo 2f91cfca671d9c482b11b8ac3281cb21378e85606494da349941fa >>"C:\Program Files\WinRAR\rarreg.key"
echo e9ee328f12dc73e90b6356b921fbfb8522d6562a6a4b97e8ef6c9f >>"C:\Program Files\WinRAR\rarreg.key"
echo fb866be1e3826b5aa126a4d2bfe9336ad63003fc0e71c307fc2c60 >>"C:\Program Files\WinRAR\rarreg.key"
echo 64416495d4c55a0cc82d402110498da970812063934815d81470829275 >>"C:\Program Files\WinRAR\rarreg.key"
goto _m1

:Choice4
cls
echo ╔┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉╗
echo.┋                      ‖                        ┋
echo ┋ A.注册表             ‖ O.计算机性能监测程序   ┋
echo.┋ B.远程桌面连接       ‖ p.事件查看器           ┋
echo ┋ C.管理控制MMC        ‖ Q.本地安全策略         ┋
echo.┋ D.检查DirectX信息    ‖ R.系统配置实用程序     ┋
echo ┋ E.系统医生           ‖ S.本地服务             ┋
echo.┋ F.设备管理器         ‖                        ┋
echo ┋ G.磁盘碎片整理程序   ‖                        ┋
echo.┋ H.磁盘管理实用程序   ‖                        ┋
echo ┋ I.系统组件服务       ‖                        ┋
echo.┋ J.记事本             ‖                        ┋
echo ┋ k.组策略             ‖                        ┋
echo.┋ L.本机用户和组       ‖                        ┋
echo ┋ M.ODBC数据源管理器   ‖                        ┋
echo.┋ N.计算机管理         ‖_______________________ ┋
echo ┋                      ‖       Y.返回菜单       ┋
echo.╚┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉╝
set choice4=
set /p choice4=          请输入对应的按回车:
IF "%Choice4%"=="" goto Choice4
if /i "%choice4%"=="A" regedit
if /i "%choice4%"=="B" mstsc
if /i "%choice4%"=="C" mmc
if /i "%choice4%"=="D" dxdiag
if /i "%choice4%"=="E" drwtsn32
if /i "%choice4%"=="F" devmgmt.msc
if /i "%choice4%"=="G" dfrg.msc
if /i "%choice4%"=="H" diskmgmt.msc
if /i "%choice4%"=="I" dcomcnfg
if /i "%choice4%"=="J" notepad
if /i "%choice4%"=="K" gpedit.msc
if /i "%choice4%"=="L" lusrmgr.msc
if /i "%choice4%"=="M" odbcad32
if /i "%choice4%"=="N" compmgmt.msc
if /i "%choice4%"=="O" perfmon
if /i "%choice4%"=="P" eventvwr
if /i "%choice4%"=="Q" secpol.msc
if /i "%choice4%"=="R" msconfig
if /i "%choice4%"=="S" services.msc
if /i "%choice4%"=="Y" goto _m1
goto Choice4

:e
set xyz=
set /p xyz=  请选择盘符后回车（必须加冒号，例：e:）:

if '%xyz%'=='' goto c
convert %xyz% /fs:ntfs&goto _m1
goto c

:d
set xyz=
set /p xyz=  请选择盘符后回车（必须加冒号，例：e:）:

if '%xyz%'=='' goto d
chkdsk %xyz% /f&goto _m1
goto d

:def
set xyz=
set /p xyz=  请选择盘符后回车（必须加冒号，例：e:）:

if '%xyz%'=='' goto def
defrag %xyz% /f /skiphigh&goto _m1
goto def

:mb
mode con cols=40 lines=5
title 简易秒表
echo.
echo      按任意键开始计时……
pause>nul
set input=0
:mq
set /a SS=%input%%%60
set /a MM=%input%/60%%60
set /a HH=%input%/3600%%60
set /a DD=%input%/86400
cls
echo.
echo.
echo       已过了%DD% 天 %HH% 小时 %MM% 分 %SS% 秒
set /a input=%input%+1
ping 127.1 -n 2 >nul
goto mq

:jsq
title 整数计算器
mode con cols=40 lines=10
:jsqfs
cls
echo.
echo                计算器
echo.
set /p hq=  请输入计算过程：
cls
set /a jshx=%hq%
echo.
echo                计算器
echo.
echo       %hq%=%jshx%
echo.
pause>nul
goto _max

:yjxs
echo exit|%ComSpec% /k prompt e 100 B4 00 B0 12 CD 10 B0 03 CD 10 CD 20 $_g$_q$_|debug>nul&chcp 437>nul&graftabl 936>nul
echo.
echo 按任意键开始
pause>nul
cls
echo.
echo                    纯色：液晶显示器坏点检测（按任意键继续）
pause>nul
color c7
pause>nul
color 27
pause>nul
color 97
pause>nul
color e7
pause>nul
color f0
pause>nul
color 87
pause>nul
exit

:dzzb
setlocal enabledelayedexpansion & mode con cols=54 lines=6 & color 0a
title 电子钟表
for %%a in (4 1 2 1 2 1 4 2 1 2 1 2 1 2 1 2 4 2 5 2 6 2 4 2 5 1 2
1 4 2 1 2 5 2 3 2 8 2 4 1 7 2 1 2 1 2 1 2 5 1 5 1 8 1 4 2 4) do (
  set /a cc=~cc
  for /l %%i in (1,1,%%a) do (if !cc!==0 (set dgts=!dgts!　) else (set dgts=!dgts!■))
)
for /l %%z in (0 0 0) do (
  if "!time:~7,1!" neq "!sec!" (
    set "sec=!time:~7,1!" & set "oc="
    for /l %%h in (0,1,4) do (
      for %%d in (0 sp 1 sp : sp 3 sp 4 sp : sp 6 sp 7) do (
        if "%%d"==":" (set /a tt=%%h*5&if "!tt:~-1!"=="0" (set oc=!oc!　) else set oc=!oc!●) else (
          if "%%d"=="sp" (set oc=!oc!　) else (
            set "timeP=!time: =0!"&set /a s=!timeP:~%%d,1!*15+%%h*3
            for %%o in (!s!) do set "oc=!oc!!dgts:~%%o,3!"
))))&cls & set /p=!oc!<nul))

:bd
mode con cols=60 lines=4
title 百度关键字搜索
echo.
set/p a=请输入要搜索的关键字: 
start http://www.baidu.com/s?wd=%a%
goto _max

:dzy
mode con: cols=62 lines=5
title 读中英文(需要中英文语音库)
:dhs
cls
set dh=
set /p dh=  请输入要读的中英文：

mshta vbscript:createobject("sapi.spvoice").speak("%dh%")(window.close)

goto _max

:24d
color 1f&mode con cols=50 lines=5
title 自动计算24点
set "code=+ - * /"&set n=1
:begin
cls&echo.&echo  请输入第%n%个(0-9内的)整数,请不要在数字前加0。
echo.&set /p num%n%= 请在这里输入：
echo !num%n%!|findstr "[^0-9]">nul&&goto wrong
set str=!num%n%!
if "!str:~,1!" equ "0" if "!str:~1!" neq "" goto wrong
if !str! gtr 9 goto wrong
set num=%num% !num%n%!&set /a n+=1
if %n% neq 5 goto begin
set num=%num:~1%
cls&echo.&echo  你输入的四个数是:%num%
echo.&echo  请稍候，正在运算中...&ping /n 2 127.1>nul
:again
set str=&set var=1234&set /a x+=1,n=4
if %x% equ 2000 cls&echo.&echo  对不起，没有算出来，或者这四个数算不出24。&pause>nul&goto _max
:lp
set /a a=%random%%%%n%,m=%random%%%4+1
set a=!var:~%a%,1!
set var=!var:%a%=!
for /f "tokens=%m% delims= " %%i in ("%code%") do set b=%%i
:add
if %n% equ 1 set "b="
set str=%str%!num%a%!%b%&set /a n-=1
if %n% neq 0 goto lp
set /a a=%str%
if %a% neq 24 goto again
cls&echo.&echo  计算结果为：%str%=24
pause>nul&goto _max
:wrong
cls&echo.&echo  输入的数不合要求，请正确输入。&ping /n 2 127.1>nul&goto begin

:zzsz
color 9f & setlocal enabledelayedexpansion
title 指针时钟
(call :init)
:loop
cls & (set /p=!strScr!!Blanks! !date! !futureTime!!Blanks!<nul)
for %%i in (!PntH!,!PntM!,!PntS!) do ( 
  for /f "tokens=1" %%p in ("!PntB!") do (set strScr=!strScr:%%i=%%p!)
)
(call :getNextSec futureTime futureDate)
(call :drawScale strScr) 
for %%i in (h,m,s) do (call :drawHand strScr !Hand%%i! %%i !futureTime!)
(call :setPoint strScr 0 0 !PntCenter!)

:testSec
(set datetime=%date:~0,10%%time:~0,8%)&&(set datetime=!datetime: =0!)
(set futureDateTime=!futureDate:~0,10!!futureTime:~0,8!)
if "!datetime!" geq "!futureDateTime!" (goto loop)

(set /a past=1!futureTime:~6,2! - 1!datetime:~16,2!) && (set past=!past:-=!)
if "!futureTime:~6,2!" equ "00" if "!datetime:~16,2!" equ "59" (goto testSec)
if !past! gtr 1 (goto loop)
goto testSec
exit /b

:init
msg %username% /time:60 请右键单击时钟窗口标题栏, 选择“属性”-^>“字体”选项卡,“点阵字体”,大小: 6 x 12,以得到更好的显示效果
set /a "size=19, HandS=size-2, HandM=HandS-3, HandH=HandM-3, rScale=size-1, width=2*size+1"
set /a "indexMax=(2*size+1)*(2*size+1)"
set /a "xStart=size, xEnd=-size, yStart=-size, yEnd=size"
set /a "Cols=(size*2+1)*2, Lines=size*2+1+1"
(set PntCenter=◎)&(set PntH=●)&(set PntM=○)&(set PntS=·)&(set PntB=▓)
(set RomanNumbers=ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ)
(set days=一二三四五六日一)
set /a "leftSpaces=size*2+1-13-1" & (set Blanks=)
for /l %%i in (1,1,!leftSpaces!) do (set Blanks= !Blanks!)
mode con cols=!Cols! Lines=!Lines!
call :math
(set strScr=) 
for /l %%i in (1,1,!indexMax!) do (set strScr=　!strScr!)
(call :creatDial strScr !PntB!)
exit /b

:math
set /a "sin0=0,sin6=105,sin12=208,sin18=309,sin24=407,sin30=500,sin36=588,sin42=669,sin48=743"
set /a "sin54=809,sin60=866,sin66=914,sin72=951,sin78=978,sin84=995,sin90=1000"
for /l %%i in (0, 6, 90) do (
  set /a "a1=180-%%i, a2=180+%%i, a3=360-%%i"
  set /a "sin!a1!=!sin%%i!, sin!a2!=-!sin%%i!, sin!a3!=-!sin%%i!"
)
for /l %%i in (0, 6, 360) do (
  set /a "a4=450-%%i, a4%%=360"
  set /a "cos%%i=sin!a4!"
)
exit /b

:creatDial
for /l %%x in (!xStart!,-1,!xEnd!) do for /l %%y in (!yStart!,1,!yEnd!) do (
  (set /a inDial=size*size-%%x*%%x-%%y*%%y+1*size) && if !inDial! geq 0 (call :setPoint %1 %%x %%y %2)
)
(call :drawScale %1)
exit /b

:drawScale
for /l %%z in (0,1,11) do ( 
  (set /a angle=%%z+1) && (set /a angle*=30)
  set /a "x=cos!angle!*rScale/sin90, y=sin!angle!*rScale/sin90"
  (set romanNum=!RomanNumbers:~%%z,1!)
  (call :setPoint %1 !x! !y! !romanNum!)
)
exit /b

:drawHand
(set timeC=%4)
(set timeh=!timeC:~0,2!)&(set timem=!timeC:~3,2!)&(set times=!timeC:~6,2!)
for %%i in (h,m,s) do if !time%%i! lss 10 (set time%%i=!time%%i:~-1!)
set /a "timeh%%=12"
set /a "angleh=30*timeh+(timem+6)/12*6, anglem=6*timem, angles=6*times"
set /a "xE=%2*cos!angle%3!*2/sin90, yE=%2*sin!angle%3!*2/sin90"
if "%5"=="" (call :line %1 0 0 !xE! !yE! %2 !Pnt%3!) else (call :line %1 0 0 !xE! !yE! %2 %5)
exit /b

:line
(set x0=%2)&(set y0=%3)&(set x1=%4)&(set y1=%5)&(set /a SQLenHand=%6*%6)
set /a "steep=(y1 - y0)*(y1 - y0) - (x1 - x0)*(x1 - x0)"
if !steep! gtr 0 (
  (set tt=!x0!&& set x0=!y0!&& set y0=!tt!)
  (set tt=!x1!&& set x1=!y1!&& set y1=!tt!)
)
if !x0! gtr !x1! (
  (set tt=!x0!&& set x0=!x1!&& set x1=!tt!)
  (set tt=!y0!&& set y0=!y1!&& set y1=!tt!)
)
set /a "deltax=x1-x0, twoDeltax=2*deltax"
set /a "twoDeltay=2*(y1-y0)" && (set twoDeltay=!twoDeltay:-=!)
set /a "eps=0, y=y0"
if !y0! lss !y1! (set yStep=1) else (set yStep=-1)
for /l %%x in (!x0!,1,!x1!) do (
  set /a "SQSum=%%x*%%x+y*y"
  if !SQSum! leq !SQLenHand! (
    if !steep! gtr 0 (call :setPoint %1 !y! %%x %7) else (call :setPoint %1 %%x !y! %7)
  )
  (set /a eps+=twoDeltay)
  if !eps! gtr !deltax! (set /a "y+=yStep, eps-=twoDeltax")
)
exit /b

:getNextSec
(set time1=!time:~0,-3!)&(set date1=!date!)
(set timeh=!time1:~0,2!)&(set timem=!time1:~3,2!)&(set times=!time1:~6,2!)
(set timeY=!date1:~0,4!)&(set timeMn=!date1:~5,2!)&(set timeD=!date1:~8,2!)&(set timeDay=!date1:~-1!)
for %%i in (h,m,s,Mn,D) do if !time%%i! lss 10 (set time%%i=!time%%i:~-1!)
(set /a "timeS=(timeS+1)%%60")
if !timeS! equ 0 (
  (set /a "timeM=(timeM+1)%%60")
  if !timeM! equ 0 (
    (set /a "timeH=(timeH+1)%%24")
    if !timeH! equ 0 (
      (set /a "timeD=timeD%%31+1")
      for %%i in (一,二,三,四,五,六,日) do (
        if "%%i"=="!timeDay!" (set nextDay=!days:*%%i=!)&&(set nextDay=!nextDay:~0,1!)
      )
      (set timeDay=!nextDay!)
      if !timeD! equ 1 (
        (set /a "timeMn=timeMn%%12+1")
        if !timeMn! equ 1 (set /a timeY+=1)
      )
    )
  )
)
for %%i in (h,m,s,Mn,D) do if !time%%i! lss 10 (set time%%i=0!time%%i!)
(set %1=!timeH!:!timeM!:!timeS!) & (set %2=!timeY!-!timeMn!-!timeD! 星期!timeDay!)
exit /b

:setPoint
set /a "index=(xStart-%2)*width+%3-yStart+1"
set /a "lenLeft=index-1, lenRight=indexMax-index"
for /f "tokens=1,2,3" %%a in ("!lenLeft! !index! !lenRight!") do (set %1=!%1:~0,%%a!%4!%1:~%%b,%%c!)
exit /b

:zlzs
title 测试你的身体质量指数(BMI)
mode con: cols=60 lines=5
:main_w
cls&echo.
set weight=[]
set /p weight=  请输入体重(单位:kg): 
call :ie weight %weight% main_w
:main_h
cls&echo.
set height=[]
set /p height=  请输入身高(单位:cm): 
call :ie height %height% main_h
set /a bmi=^(%weight%*10000^)/^(%height%*%height%^)
call :out %bmi%

:out
set "yo=if %1 equ %%a msg /v /w %username%"
if %1 gtr 30 msg /v /w %username% " 不要再闹了！！！哪有这种身材 ">nul&goto _max
for /l %%a in (28 1 30) do %yo% " BMI：%bmi% 你再不减肥就完蛋了! ">nul&goto _max
for /l %%a in (24 1 27) do %yo% " BMI：%bmi% 你是不是胖了点? ">nul&goto _max
for /l %%a in (21 1 23) do %yo% " BMI：%bmi% 我敢打赌,你一定经常抢吃,不然不会偏胖! ">nul&goto _max
for /l %%a in (19 1 20) do %yo% " BMI：%bmi% 哇！！棒极了，是标准身材！ ">nul&goto _max
for /l %%a in (17 1 18) do %yo% " BMI：%bmi% 朋友，明显你营养不良(-_-)！ ">nul&goto _max
if %1 lss 17 msg /v /w %username% " 按照生物学来说这种生物是不能生存的！ ">nul&goto _max

:ie
if "%1"=="[]" goto %3
echo %2|findstr "^[1-9][0-9]*$">nul||goto %3
if %2 geq 250 msg /v /w %username% "  你输入的数字让我头都大了,按确定重新输入!">nul&goto %3
goto :eof

:pcljm
mode con cols=100 lines=8
set "origFile=
set /p "origFile=  请输入文件位置: 
set "newFile=%~dpn1_new%~x1"
> "%newFile%" echo CreateObject^("Scripting.FileSystemObject"^). _
>>"%newFile%" echo CreateTextFile^("%newFile%", True, vbTrue^).Write "::(P)&(C)2010 Spring"
cscript -nologo -e:vbs "%newFile%"
>>"%newFile%" (echo.&echo.&echo,cls)
>>"%newFile%" type "%origFile%"
echo  %origFile%
echo  变成乱码后的文件是
echo  %newFile%
ping /n 4 127.1>nul
goto _max

:wlpz
call :select "ip address" "ip"
call :select "Physical Address" "mac"
call :select "Default Gateway" "gateway"
call :select "DNS Servers" "dns"
call :select "Description" "netcard"

echo IP:%ip%
echo MAC:%mac%
echo DNS:%dns%
echo GATEWAY:%gateway%
echo NETCARD:%netcard%
pause>nul
goto _max
:select
for /f "tokens=2 delims=:" %%i in ('ipconfig /all ^| findstr /i /c:%1') do if not "!%~2!" == "" set "%~2=%%i"
goto :eof

:ljjc
echo for each ps in getobject _ >ps.vbs
echo ("winmgmts:\\.\root\cimv2:win32_process").instances_ >>ps.vbs
echo wscript.echo ps.handle^&vbtab^&ps.name^&vbtab^&ps.executablepath:next >>ps.vbs
echo PID     图像名          程序位置>%windir%\jc.txt
echo ======  =============== ==============================================================================================================>>%windir%\jc.txt
cscript //nologo ps.vbs>>%windir%\jc.txt & del ps.vbs
jc.txt
goto _max

:qlss
mode con: cols=85 lines=200
:wjglm
title 当前目录：%cd%
cls
echo 文件管理器
echo.
set num=0
echo  序号  文件名
for /f "tokens=*" %%a in ('dir /b') do set /a num+=1&echo  [!num!]  %%a&set "rmpvar=%%a"
set mem=
set /p mem=请输入 打开直接输入文件名 删除【D】创建快捷方式【S】转换目录【E】关闭【C】编辑【T】：
if '%mem%'=='' goto wjglm
if /i '%mem%'=='D' goto delete
if /i '%mem%'=='S' goto cjkjfs
if /i '%mem%'=='C' goto _max
if /i '%mem%'=='E' goto mldir
if /i '%mem%'=='T' goto editw
start "" %mem%
goto wjglm

:delete
set wz=
set /p wz=  请输入文件（夹）名: 
if '%wz%'=='' goto delete
echo y|Cacls %wz% /c  /t /p Everyone:f>nul 2>nul
DEL /F/A/Q %wz% >nul 2>nul
RD /S /Q \\?\%wz% >nul 2>nul
goto wjglm

:cjkjfs
set /p fileName=      [请输入文件或者目录的全路径]:
if /i "!fileName!"=="" goto :enterFileName
if not exist "%filename%" cls & echo 你输入的目录或者文件名不存在，请重新输入 & pause & goto :enterFileName
echo.
for %%i in ("!fileName!") do set name=%%~ni
set /p shortCutPath=      [请输入将创建方式保存到的路径]:
set shortCutPath="!shortCutPath!\!name!.lnk"
echo Dim WshShell,Shortcut>>tmp.vbs
echo Dim path,fso>>tmp.vbs
echo path="%fileName%">>tmp.vbs
echo Set fso=CreateObject("Scripting.FileSystemObject")>>tmp.vbs
echo Set WshShell=WScript.CreateObject("WScript.Shell")>>tmp.vbs
echo Set Shortcut=WshShell.CreateShortCut(%shortCutPath%)>>tmp.vbs
echo Shortcut.TargetPath=path>>tmp.vbs
echo Shortcut.Save>>tmp.vbs
"%SystemRoot%\System32\WScript.exe" tmp.vbs
del tmp.vbs /s /q
cls
if exist %shortCutPath% echo 快捷方式创建完毕... & pause>nul
if not exist %shortCutPath% echo 快捷方式创建失败,请重新操作... & pause>nul
goto wjglm

:mldir
set xyz=
set /p xyz=  请输入要转换的目录，输入..后退一个目录

if '%xyz%'=='' goto mldir
cd %xyz%&goto wjglm

:editw
set mz=
set /p mz=  请输入要编辑的文件

if '%mz%'=='' goto editw
NOTEPAD.EXE %mz%&goto wjglm


:shutdown
cls
echo ╔┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉╗
echo.┋                       ‖                       ┋
echo ┋ A.定时关机            ‖ F.休眠                ┋
echo.┋ B.倒计时关机          ‖ G.定时注销本机        ┋
echo ┋ C.删除定时关机任务    ‖ H.定时重启本机        ┋
echo.┋ D.查看定时关机任务状态‖                       ┋
echo.┋ E.定时锁定本机        ‖_______________________┋
echo ┋                       ‖      Y.返回菜单       ┋
echo.╚┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉┉╝
echo.
echo. 
SET a=
SET /P a=请输入对应的按回车:
ECHO.
IF /I '%a%'=='A' goto dsgj
IF /I '%a%'=='B' goto djsgj
IF /I '%a%'=='C' goto scdsgj
IF /I '%a%'=='D' goto ckgj
IF /I '%a%'=='E' goto dssd
IF /I '%a%'=='G' goto dszx
IF /I '%a%'=='H' goto dscq
IF /I '%a%'=='F' %windir%\system32\rundll32.exe powrprof.dll,SetSuspendState
if /i "%a%"=="Y" goto _max
goto shutdown
:dsgj
echo 请输入关机时间,(如12:00:00)
set shutdowntime=
set /p shutdowntime=
at %shutdowntime% tsshutdn 0 /delay:0 /powerdown >nul
IF not errorlevel 1 goto ok
echo %shutdowntime% 不是标准的时间格式,请重新输入
echo.
goto dsgj
:ok
echo.
echo 设定完毕! 按任意键继续...
pause >nul
cls
goto shutdown
:djsgj
echo 您想要多少秒后关机
echo (若设定后要取消,单击"确定"后按Ctrl+C键两次)
set timed=
set /p timed=输入:
tsshutdn %timed% /delay:0  /powerdown >nul
IF not errorlevel 1 goto ok
echo %timed% 是无效的关机时间,请重新输入
echo.
goto djsgj
:scdsgj
at /del /y
echo 定时关机任务已取消,按任意键继续...
pause >nul
cls
goto shutdown
:ckgj
at
pause
cls
goto shutdown
:logoff
logoff
:dssd
echo 0 为立即锁定本机,其他数字以分钟为单位!
set /p var=请输入多少分钟后锁定本机(如3): 
set /a var*=60
:锁
echo !var!秒后锁定本机! CTRL+C取消.
ping /n 6 127.1>nul
if !var! LEQ 0 (goto 锁定) else set /a var-=5 & goto 锁
:锁定
rundll32.exe user32.dll,LockWorkStation
:dszx
echo 0 为立即注销本机,其他数字以分钟为单位!
set /p var=请输入多少分钟后注销本机(如3): 
set /a var*=60
:注
echo !var!秒后注销! CTRL+C取消.
ping /n 6 127.1>nul
if !var! LEQ 0 (goto 注销) else set /a var-=5 & goto 注
:注销
shutdown /l 
:dscq
echo 0 为立即重启动本机,其他数字以分钟为单位!
set /p var=请输入多少分钟后重启动本机(如3): 
set /a var*=60
:重
echo !var!秒后重启动! CTRL+C取消.
ping /n 6 127.1>nul
if !var! LEQ 0 (goto 重启动) else set /a var-=5 & goto 重
:重启动
shutdown /r /t 0

:bsqlg
mode con cols=50 lines=3
set times=%time:~0,2%点%time:~3,2%分
echo.
echo                   %times%%time:~6,2%秒
mshta vbscript:createobject("sapi.spvoice").speak("现在是北京时间%times%")(window.close)
goto _max

:bszlgo
title 整点报时钟
mode con cols=20 lines=3
:msad
set timed=%time:~0,2%点
set tims=%time:~3,2%分%time:~6,2%秒
echo.
echo     %timed%%tims%
if '%tims%'=='00分00秒' mshta vbscript:createobject("sapi.spvoice").speak("现在是北京时间%timed%整")(window.close)
ping 127.1 -n 2 >nul
goto msad

:rlszcd
set str=日一二三四五六七八九
cls
for /f "tokens=1,2,3 delims=-/: " %%i in ("%date%") do (
    (set sy=%%i) && (set sm=%%j) && (set sd=%%k)
)
if not defined sd set sd=1
if not defined sm set sm=%sy%&set sy=%date:~0,4%
(set sy=0000%sy%) && (set sm=00%sm%) && (set sd=00%sd%)
(set sy=%sy:~-4%) && (set sm=%sm:~-2%) && (set sd=%sd:~-2%)
set /a y=1%sy%-10000, m=1%sm%-100, d=1%sd%-100 2>nul
if %y% lss 100 (
    if %y% lss 50 (set /a y+=2000) else (set /a y+=1900)
    set sy=!y!
)
if %m% lss 13 if %d% lss 32 goto Calc
:Calc
set/a Q=(y-1901)/4
set/a R=y-1901-4*Q
set n=0
for %%i in (0,31,59,90,120,151,181,212,243,273,304,334) do (
set /a n+=1
if %m% equ !n! set z=%%i)
set /a leap="^!(y%%4) & ^!(^!(y%%100)) | ^!(y%%400)"
if %m% gtr 2 (if %leap% equ 0 (set /a z-=1) else (set /a z+=leap))
set/a n=(140*Q+106*(R+1)+z*10+d*10)/295,H=(140*Q+106*(R+1)+z*10+d*10-295*n)/10
if %h% equ 0 set h=29
if %h% leq 10 (if %h% equ 10 (set h=初十) else (set h=初%h%)) else (set h=%h:~0,1%十%h:~-1%号)
for /l %%i in (1,1,9) do (call set h=%%h:%%i=!str:~%%i,1!%%)
set h=%h:0=%
set sx=猴鸡狗猪鼠牛虎兔龙蛇马羊
set tg=庚辛壬癸甲乙丙丁戊己
set dz=申酉戌亥子丑寅卯辰巳午未
set /a sxnum=%sy% %% 12
set /a tgnum=%sy:~-1%
title 农历!tg:~%tgnum%,1!!dz:~%sxnum%,1!年 生肖:!sx:~%sxnum%,1! 农历:%h%
echo.正在启动，请稍后
mode con: cols=38 lines=19
set yy=%date:~0,4%
set zg=%yy%年%date:~5,2%月%date:~8,2%日
set abc=无
if /i '%zg%'=='%yy%年01月01日' set abc=今天是元旦
if /i '%zg%'=='%yy%年01月06日' set abc=今天是中国13亿人口日
if /i '%zg%'=='%yy%年01月10日' set abc=今天是中国110宣传日
if /i '%zg%'=='%yy%年02月02日' set abc=今天是世界湿地日
if /i '%zg%'=='%yy%年02月04日' set abc=今天是世界抗癌症日
if /i '%zg%'=='%yy%年02月10日' set abc=今天是世界气象日
if /i '%zg%'=='%yy%年02月14日' set abc=今天是情人节
if /i '%zg%'=='%yy%年02月21日' set abc=今天是国际母语日
if /i '%zg%'=='%yy%年02月07日' set abc=今天是国际声援南非日
if /i '%zg%'=='%yy%年02月29日' set abc=今天是国际罕见病日
if /i '%zg%'=='%yy%年03月03日' set abc=今天是全国爱耳日
if /i '%zg%'=='%yy%年03月08日' set abc=今天是妇女节
if /i '%zg%'=='%yy%年03月12日' set abc=今天是植树节
if /i '%zg%'=='%yy%年03月15日' set abc=今天是国际消费日
if /i '%zg%'=='%yy%年03月21日' set abc=今天是世界森林日
if /i '%zg%'=='%yy%年03月22日' set abc=今天是世界水日
if /i '%zg%'=='%yy%年03月23日' set abc=今天是世界气象日
if /i '%zg%'=='%yy%年03月24日' set abc=今天是世界防治结核病日
if /i '%zg%'=='%yy%年04月01日' set abc=今天是愚人节
if /i '%zg%'=='%yy%年04月07日' set abc=今天是世界卫生日
if /i '%zg%'=='%yy%年04月22日' set abc=今天是世界地球日
if /i '%zg%'=='%yy%年05月01日' set abc=今天是国际劳动节
if /i '%zg%'=='%yy%年05月04日' set abc=今天是中国青年节
if /i '%zg%'=='%yy%年05月05日' set abc=今天是全国碘缺乏病日
if /i '%zg%'=='%yy%年05月08日' set abc=今天是世界红十字日
if /i '%zg%'=='%yy%年05月12日' set abc=今天是国际护士节
if /i '%zg%'=='%yy%年05月15日' set abc=今天是国际家庭日
if /i '%zg%'=='%yy%年05月17日' set abc=今天是世界电信日
if /i '%zg%'=='%yy%年05月18日' set abc=今天是国际博物馆日
if /i '%zg%'=='%yy%年05月19日' set abc=今天是中国汶川地震哀挨哀悼日
if /i '%zg%'=='%yy%年05月20日' set abc=今天是全国学生营养日
if /i '%zg%'=='%yy%年05月22日' set abc=今天是国际生物多样性日
if /i '%zg%'=='%yy%年05月31日' set abc=今天是世界无烟日
if /i '%zg%'=='%yy%年06月01日' set abc=今天是国际儿童节

if /i '%zg%'=='%yy%年06月05日' set abc=今天是世界环境日
if /i '%zg%'=='%yy%年06月06日' set abc=今天是全国爱眼日

if /i '%zg%'=='%yy%年06月17日' set abc=今天是防治荒漠化和干旱日

if /i '%zg%'=='%yy%年06月23日' set abc=今天是国际奥林匹克日

if /i '%zg%'=='%yy%年06月25日' set abc=今天是全国土地日

if /i '%zg%'=='%yy%年06月26日' set abc=今天是国际反毒品日

if /i '%zg%'=='%yy%年07月01日' set abc=今天是香港回归日、建党节

if /i '%zg%'=='%yy%年07月07日' set abc=今天是抗日战争纪念日

if /i '%zg%'=='%yy%年07月08日' set abc=今天是世界过敏性疾病日

if /i '%zg%'=='%yy%年07月11日' set abc=今天是世界人口日
if /i '%zg%'=='%yy%年07月28日' set abc=今天是制作者的生日
if /i '%zg%'=='%yy%年08月01日' set abc=今天是八一建军节
if /i '%zg%'=='%yy%年05月01日' set abc=今天是劳动节
if /i '%zg%'=='%yy%年09月08日' set abc=今天是国际扫盲日

if /i '%zg%'=='%yy%年09月10日' set abc=今天是教师节、世界预防自杀日
if /i '%zg%'=='%yy%年09月16日' set abc=今天是国际臭氧层保护日
if /i '%zg%'=='%yy%年09月17日' set abc=今天是国际和平日
if /i '%zg%'=='%yy%年09月20日' set abc=今天是国际爱牙日

if /i '%zg%'=='%yy%年09月27日' set abc=今天是世界旅游日
if /i '%zg%'=='%yy%年10月01日' set abc=今天是国庆节、国际音乐节
if /i '%zg%'=='%yy%年10月02日' set abc=今天是国际减轻自然灾害日

if /i '%zg%'=='%yy%年10月04日' set abc=今天是世界动物日

if /i '%zg%'=='%yy%年10月07日' set abc=今天是国际住房日

if /i '%zg%'=='%yy%年10月08日' set abc=今天是全国高血压日、世界视觉日
if /i '%zg%'=='%yy%年10月09日' set abc=今天是世界邮政日

if /i '%zg%'=='%yy%年10月10日' set abc=今天是世界精神卫生日

if /i '%zg%'=='%yy%年10月15日' set abc=今天是国际盲人节

if /i '%zg%'=='%yy%年10月16日' set abc=今天是世界粮食节

if /i '%zg%'=='%yy%年10月17日' set abc=今天是世界消除贫困日
if /i '%zg%'=='%yy%年10月21日' set abc=今天是中国（揭阳）国际玉器节

if /i '%zg%'=='%yy%年10月22日' set abc=今天是世界传统医药日

if /i '%zg%'=='%yy%年10月24日' set abc=今天是联合国日
if /i '%zg%'=='%yy%年10月25日' set abc=今天是人类天花绝迹日

if /i '%zg%'=='%yy%年10月26日' set abc=今天是足球诞生日

if /i '%zg%'=='%yy%年10月31日' set abc=今天是万圣节
if /i '%zg%'=='%yy%年11月08日' set abc=今天是中国记者日

if /i '%zg%'=='%yy%年11月09日' set abc=今天是消防宣传日

if /i '%zg%'=='%yy%年11月14日' set abc=今天是世界糖尿病日

if /i '%zg%'=='%yy%年11月17日' set abc=今天是国际大学生节

if /i '%zg%'=='%yy%年12月01日' set abc=今天是世界艾滋病日

if /i '%zg%'=='%yy%年12月03日' set abc=今天是世界残疾人日

if /i '%zg%'=='%yy%年12月09日' set abc=今天是世界足球日

if /i '%zg%'=='%yy%年12月20日' set abc=今天是澳门回归纪念日

if /i '%zg%'=='%yy%年12月21日' set abc=今天是国际篮球日

if /i '%zg%'=='%yy%年12月24日' set abc=今天是平安夜

if /i '%zg%'=='%yy%年12月25日' set abc=今天是圣诞节、世界强化免疫日

if /i '%zg%'=='%yy%年12月26日' set abc=今天是毛泽东诞辰
set rq=
set sj=
set xq=
set y=
set r=
set n=
:gn---6-cf
set ra=
set rb=
set rc=
set +1=
set y=%date:~5,-7%
set r=%date:~8,-4%
set n=%date:~0,-10%
set xq=%date:~13,1%
set sj=%time:~0,-9%时%time:~3,-6%分%time:~6,-3%秒
if %xq%==六 (color fc&goto tgcolor) else (goto cr)
:cr
if %xq%==日 (color fc) else (color f0)
:tgcolor
if %y% equ 01 (set yue=  一月大)
if %y% equ 02 (set yue=  二月小)
if %y% equ 03 (set yue=  三月大)
if %y% equ 04 (set yue=  四月小)
if %y% equ 05 (set yue=  五月大)
if %y% equ 06 (set yue=  六月小)
if %y% equ 07 (set yue=  七月大)
if %y% equ 08 (set yue=  八月大)
if %y% equ 09 (set yue=  九月小)
if %y% equ 10 (set yue=  十月大)
if %y% equ 11 (set yue=十一月小)
if %y% equ 12 (set yue=十二月大)
set ra=%r:~0,-1%
set rb=%r:~1,1%
if %ra% equ 0 (
set rc=y
if %rb% equ 1 (
set r1=      █      
set r2=    ██      
set r3=      █      
set r4=      █      
set r5=      █      
set r6=      █      
set r7=      █      
set r8=   ████   
)
if %rb% equ 2 (
set r1=     ██     
set r2=   █    █   
set r3=          █  
set r4=         █   
set r5=        █    
set r6=      █      
set r7=    █        
set r8=   ████   
)
if %rb% equ 3 (
set r1=     ██     
set r2=   █    █   
set r3=        █    
set r4=      █      
set r5=        █    
set r6=   █    █   
set r7=     ██     
set r8=              
)
if %rb% equ 4 (
set r1=       █     
set r2=      █▌    
set r3=     ██     
set r4=    █ █     
set r5=   █  █     
set r6=  █████  
set r7=       █     
set r8=       █     
)
if %rb% equ 5 (
set r1=    ███    
set r2=    █        
set r3=    █        
set r4=    ███    
set r5=        █    
set r6=        █    
set r7=    ███    
set r8=              
)
if %rb% equ 6 (
set r1=       █     
set r2=     █       
set r3=    █        
set r4=   █ █▋    
set r5=   █▌  █   
set r6=   █    █   
set r7=    █  █    
set r8=      █      
)
if %rb% equ 7 (
set r1=  █████  
set r2=          █  
set r3=         █   
set r4=        █    
set r5=       █     
set r6=      █      
set r7=     █       
set r8=    █        
)
if %rb% equ 8 (
set r1=     ██     
set r2=   █    █   
set r3=   █    █   
set r4=     ██     
set r5=   █    █   
set r6=   █    █   
set r7=     ██     
set r8=              
)
if %rb% equ 9 (
set r1=     ██     
set r2=   █    █   
set r3=   █    █   
set r4=     ██     
set r5=         █   
set r6=   █    █   
set r7=     ██     
set r8=              
)
) else (
if %rb% equ 0 (
set r9 =███
set r10=█  █
set r11=█  █
set r12=█  █
set r13=█  █
set r14=█  █
set r15=███
set r16=      
)
if %rb% equ 1 (
set r9 =  █  
set r10=  █  
set r11=  █  
set r12=  █  
set r13=  █  
set r14=  █  
set r15=  █  
set r16=      
)
if %rb% equ 2 (
set r9 =███
set r10=    █
set r11=    █
set r12=███
set r13=█    
set r14=█    
set r15=███
set r16=      
)
if %rb% equ 3 (
set r9 =███
set r10=    █
set r11=    █
set r12=███
set r13=    █
set r14=    █
set r15=███
set r16=      
)
if %rb% equ 4 (
set r9 =█  █
set r10=█  █
set r11=█  █
set r12=███
set r13=    █
set r14=    █
set r15=    █
set r16=      
)
if %rb% equ 5 (
set r9 =███
set r10=█    
set r11=█    
set r12=███
set r13=    █
set r14=    █
set r15=███
set r16=      
)
if %rb% equ 6 (
set r9 =███
set r10=█    
set r11=█    
set r12=███
set r13=█  █
set r14=█  █
set r15=███
set r16=      
)
if %rb% equ 7 (
set r9 =███
set r10=█  █
set r11=    █
set r12=    █
set r13=    █
set r14=    █
set r15=    █
set r16=      
)
if %rb% equ 8 (
set r9 =███
set r10=█  █
set r11=█  █
set r12=███
set r13=█  █
set r14=█  █
set r15=███
set r16=      
)
if %rb% equ 9 (
set r9 =███
set r10=█  █
set r11=█  █
set r12=███
set r13=    █
set r14=    █
set r15=███
set r16=      
)
)
if %ra% equ 1 (
set r1=  █  
set r2=  █  
set r3=  █  
set r4=  █  
set r5=  █  
set r6=  █  
set r7=  █  
set r8=      
)
if %ra% equ 2 (
set r1=███
set r2=    █
set r3=    █
set r4=███
set r5=█    
set r6=█    
set r7=███
set r8=      
)
if %ra% equ 3 (
set r1=███
set r2=    █
set r3=    █
set r4=███
set r5=    █
set r6=    █
set r7=███
set r8=      
)
if not defined rc (
set r1=%r1%  %r9 %
set r2=%r2%  %r10%
set r3=%r3%  %r11%
set r4=%r4%  %r12%
set r5=%r5%  %r13%
set r6=%r6%  %r14%
set r7=%r7%  %r15%
set r8=%r8%  %r16%
) else (
cls
)
:cf2-gn---6
set sj=%time:~0,-9%时%time:~3,-6%分%time:~6,-3%秒
cls
echo.
echo. ┌────────────────┐
echo. │%n%年     日历时钟     %yue%│
echo. ├────────────────┤
echo. │%sj%                    │
echo. │星期%xq%                          │
echo. │         %r1%         │
echo. │         %r2%         │
echo. │         %r3%         │
echo. │         %r4%         │
echo. │         %r5%         │
echo. │         %r6%         │
echo. │         %r7%         │
echo. │         %r8%         │
echo. ├────────────────┤
echo. │          作者：Dr.ma           │
echo. └────────────────┘
echo   节日：%abc%
ping 127.1 -n 2 >nul
goto gn---6-cf

:hbmp3zb
title 合并文件

:main23
mode con cols=31 lines=12
cls&set file=
echo "        _______             "
echo "       / file  |            "
echo "       |::::   |   DRAG     "
echo "       | ::::  |   HERE     "
echo "       |  :::: |            "
echo "       |_______|            "
echo.
echo  请拖入欲合并的文件到此窗口
echo  然后按“回车”(Enter)。（用
echo  “+”隔开）
set /p file=

if '%file%'=='' goto main23

:wind23
cls&set file2=
echo "        _______             "
echo "       / file  |            "
echo "       |::::   |   DRAG     "
echo "       | ::::  |   HERE     "
echo "       |  :::: |            "
echo "       |_______|            "
echo.
echo.
echo  请输入保存名称（格式：c:\ma.*
echo   ）然后按“回车”(Enter)
set /p file2=

if '%file2%'=='' goto wind23

:star23
cls
echo.
echo.
echo 合并中……
copy /b %file% %file2% >nul 2>nul
echo 完成！按任意键返回……
pause>nul
goto _max

:hbbsbsb
cd /d %~dp0
title ExtractMSI v2 修订版
set time=0

:main
mode con cols=31 lines=10
if not "%~1"=="" set file=%~1&& goto special
cls&set file=
echo "        _______             "
echo "       / MSI   |            "
echo "       |::::   |   DRAG     "
echo "       | ::::  |   HERE     "
echo "       |  :::: |            "
echo "       |_______|            "
echo.
echo  请拖入欲解压的MSI文件到此窗口
echo  然后按“回车”(Enter)。
set /p file=

:checkfile
if not exist "%file%" set error=file&&goto error
call :get %file%
if "%x%"==".msi" (goto extract) else (set error=msi)
goto error

:extract
set select=
cls
mode con cols=60 lines=15
echo.
echo  本软件猜你要解压
echo  %nx%&echo.
echo  到：
echo  %guess%&echo.
echo  直接回车以采用以上路径&echo.
set /p select=→
if "%select%"=="" set target=%guess%&&goto confirm

:guessagain
cls&set select2=
echo.&echo  我猜我猜我猜猜猜…… 你的意思是解压到……
echo.&echo  1-%dp%%select%&echo.&echo  2-%d%\%select%
echo.&echo  .-返回   ..-重新选择文件&echo.
set /p select2=选择→
if "%select2%"=="1" set target=%dp%%select%&&goto confirm
if "%select2%"=="2" set target=%d%\%select%&&goto confirm
if "%select2%"=="." goto extract
if "%select2%"==".." goto main
goto guessagain

:error
cls
echo 别玩了，这是什么玩意儿~
echo.
if "%error%"=="msi" echo 只可以拖入msi文件！
if "%error%"=="file" echo 文件根本不存在！
pause>nul
goto main

:get
set d=%~d1
set x=%~x1
set n=%~n1
set nx=%~nx1
set dp=%~dp1
set guess=%~dpn1
exit /b

:confirm
cls
echo.&echo  最后确认&echo.&echo  解压%nx%
echo.&echo  到%target%
echo.&echo  ,- 确定   .- 返回&echo.
set /p select=
if "%select%"=="," goto process
if "%select%"=="." goto extract
goto confirm

:process
mode con cols=31 lines=10
set file=%file:"=%
cls
echo.&echo  已调用msiexec.exe来解压，
echo  如果看不见请等一会儿。&echo.
msiexec.exe /a "%file%" /qb targetdir="%target%"
if exist "%target%" (echo  应该可以了，按任意键去看看吧~) else (echo  你似乎取消了…… 任意键退出)
pause>nul
if exist "%target%" explorer "%target%"
exit

:special
call :get "%file%"
if "%x%"==".msi" (goto extract) else (set error=msi)
goto error
goto _max

:Zzdszip
echo 正在为您设置IP，请稍等......
set /A "a=%RANDOM%%%250+3
set /A "b=%RANDOM%%%250+3
set /A "c=%RANDOM%%%250+3
netsh interface ip set address name="本地连接" source=static addr=10.%a%.%b%.%c% mask=255.0.0.0 >nul
:start
set /A "num=%RANDOM%%%190+10"
ping 10.1.1.%num% -n 1 >nul
arp -a |find "10.1.1.%num%" &&goto start
netsh interface ip set address name="本地连接" source=static addr=10.1.1.%num% mask=255.255.255.0 gateway=10.1.1.250 gwmetric=0 | find "IP地址已在网络上使用" &&goto start
netsh interface ip set dns "本地连接" source=static addr=10.1.1.100 register=primary >nul 
netsh interface ip add dns "本地连接" addr=8.8.8.8 >nul
netsh interface ip set wins name="本地连接" source=static addr=10.1.1.100 >nul
if %errorlevel% neq 0 goto start
goto _max

:Registry_Scan
Title 注册表扫描
mode con cols=80 lines=15
cls
echo.
echo.
echo        正 在 扫 描
echo.
echo                                              请稍后......
echo.
echo.
set a=^set /p= ■%b%^<nul^&ping/n 0 127.1^>nul^&
set/p=    <nul&&%e%%a%%a%
set /a NO._Abnormal=0,NO._Succeed=0,NO._Fail=0
set RExplorer="HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer"
set RSystem="HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System"
set RIE="HKEY_CURRENT_USER\Software\Policies\Microsoft\Internet Explorer\Control Panel"
set RIER="HKEY_CURRENT_USER\Software\Policies\Microsoft\Internet Explorer\Restrictions"
set/p=<nul&&%a%%a%
reg query %RExplorer%>nul 2>nul
if %errorlevel%==0 (
    for %%e in (
        LockTaskbar
        NoChangeStartMenu
        NoSetTaskbar
        StartMenuLogOff
        NoRun
        NoFind
        NoSetFolders
        NoClose
        NoRecentDocsMenu
        NoSMHelp
        Start_ShowControlPanel
        Start_ShowMyComputer
        NoSMMyDocs
        NoStartMenuMyMusic
        NoSMMyPictures
        Start_ShowNetConn
        NoStartMenuMorePrograms
        NoStartMenuMFUProgramsList
        NoPropertiesMyComputer
        NoManageMyComputerVerb
        NoPropertiesMyDocuments
        NoInternetIcon
        NoShellSearchButton
        NoTrayItemsDisplay
        HideClock
        NoWinKeys
        NoViewContextMenu
        NoExpandedNewMenu
        NoBandCustomize
    ) do (
        set v%%e=正常
        set dv%%e=不需要
        for /f "tokens=3" %%i in ('reg query %RExplorer%^|findstr /i %%e') do (
            if "%%i"=="0x1" (
                set v%%e=异常
                set /a NO._Abnormal+=1
                reg delete %RExplorer% /v %%e /f>nul
                if %errorlevel%==1  (
                    set dv%%e=  ×
                    set /a NO._Fail+=1
                )
                if %errorlevel%==0 (
                    set dv%%e=  √
                    set /a NO._Succeed+=1
                )
            )
        )
    )
)
set/p=<nul&&%a%%a%
reg query %RExplorer%>nul 2>nul
if %errorlevel%==0 (
    for %%d in (
        Noviewondrive
        NoDrives
    ) do (
        set v%%d=正常
        set dv%%d=不需要
        for /f "tokens=3" %%i in ('reg query %RExplorer%^|findstr /i %%d') do (
            if "%%i"=="0x1" (
                set v%%d=异常
                set /a NO._Abnormal+=1
                reg delete %RExplorer% /v %%d /f>nul
                if %errorlevel%==1  (
                    set dv%%e=  ×
                    set /a NO._Fail+=1
                )
                if %errorlevel%==0 (
                    set dv%%e=  √
                    set /a NO._Succeed+=1
                )
            )
        )
    )
)
set/p=<nul&&%a%%a%%a%%a%%a%%a%
reg query %RSystem%>nul 2>nul
if %errorlevel%==0 (
    for %%s in (
        NoDispBackgroundPage
        NoDispAppearancePage
        NoDispSettingsPage
        NoDispScrSavPage
    ) do (
        set v%%s=正常
        set dv%%s=不需要
        for /f "tokens=3" %%i in ('reg query %RSystem%^|findstr /i %%s') do (
            if "%%i"=="0x1" (
                set v%%s=异常
                set /a NO._Abnormal+=1
                reg delete %RSystem% /v %%s /f>nul
                if %errorlevel%==1  (
                    set dv%%s=  ×
                    set /a NO._Fail+=1
                )
                if %errorlevel%==0 (
                    set dv%%s=  √
                    set /a NO._Succeed+=1
                )
            )
        )
    )
)
set/p=<nul&&%a%%a%
reg query %RIE%>nul 2>nul
if %errorlevel%==0 (
    for %%n in (
        GeneralTab
        SecurityTab
        PrivacyTab
        ContentTab
        ConnectionsTab
        ProgramsTab
        AdvancedTab
        HomePage
        cache
        settings
        history
        colour
        fonts
        languages
        accessibility
        Advanced
    ) do (
        set v%%n=正常
        set dv%%n=不需要
        for /f "tokens=3" %%i in ('reg query %RIE%^|findstr /i %%n') do (
            if "%%i"=="0x1" (
                set v%%n=异常
                set /a NO._Abnormal+=1
                reg delete %RIE% /v %%n /f>nul
                if %errorlevel%==1  (
                    set dv%%n=  ×
                    set /a NO._Fail+=1
                )
                if %errorlevel%==0 (
                    set dv%%n=  √
                    set /a NO._Succeed+=1
                )
            )
        )
    )
)
set/p=<nul&&%a%%a%%a%%a%
reg query %RIER%>nul 2>nul
if %errorlevel%==0 (
    for %%m in (
        NoFileOpen
        NoBrowserClose
        NoFileNew
        NoViewSouree
        NoTheaterMode
        NoBrowserOptions
    ) do (
        set v%%m=正常
        set dv%%m=不需要
        for /f "tokens=3" %%i in ('reg query %RIER%^|findstr /i %%m') do (
            if "%%i"=="0x1" (
                set v%%m=异常
                set /a NO._Abnormal+=1
                reg delete %RIER% /v %%m /f>nul
                if %errorlevel%==1  (
                    set dv%%m=  ×
                    set /a NO._Fail+=1
                )
                if %errorlevel%==0 (
                    set dv%%m=  √
                    set /a NO._Succeed+=1
                )
            )
        )
    )
)
set/p=<nul&&%a%%a%
set dvexe=不需要
set dvbat=不需要
set dvtxt=不需要
set dvini=不需要
set dvvbs=不需要
set dvcom=不需要
for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.exe" ^| find /i "没有名称"') do (
    if "%%i"=="exefile" (
        set vexe=正常
    ) else (
        set vexe=异常
        set /a NO._Abnormal+=1
        assoc .exe=exefile>nul
        if %errorlevel%==1  (
            set dvexe=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvexe=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%
for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.bat" ^| find /i "没有名称"') do (
    if "%%i"=="batfile" (
        set vbat=正常
        ) else (
        set vbat=异常
        set /a NO._Abnormal+=1
        assoc .bat=batfile>nul
        if %errorlevel%==1  (
            set dvbat=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvbat=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%
for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.txt" ^| find /i "没有名称"') do (
    if "%%i"=="txtfile" (
        set vtxt=正常
        ) else (
        set vtxt=异常
        set /a NO._Abnormal+=1
        assoc .txt=txtfile>nul
        if %errorlevel%==1  (
            set dvtxt=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvtxt=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%
    for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.ini" ^| find /i "没有名称"') do (
        if "%%i"=="inifile" (
        set vini=正常
        ) else (
        set vini=异常
        set /a NO._Abnormal+=1
        assoc .ini=inifile>nul
        if %errorlevel%==1  (
            set dvini=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvini=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%
for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.vbs" ^| find /i "没有名称"') do (
    if "%%i"=="vbsfile" (
    set vvbs=正常
    ) else (
        set vvbs=异常
        set /a NO._Abnormal+=1
        assoc .vbs=vbsfile>nul
        if %errorlevel%==1  (
            set dvvbs=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvvbs=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%
for /f "tokens=3" %%i in ('reg query "HKEY_CLASSES_ROOT\.com" ^| find /i "没有名称"') do (
    if "%%i"=="comfile" (
    set vcom=正常
    ) else (
        set vcom=异常
        set /a NO._Abnormal+=1
        assoc .com=comfile>nul
        if %errorlevel%==1  (
            set dvcom=  ×
            set /a NO._Fail+=1
        )
        if %errorlevel%==0 (
            set dvcom=  √
            set /a NO._Succeed+=1
        )
    )
)
set/p=<nul&&%a%%a%

echo.
echo.
echo.
echo   任意键查看扫描结果   （仅显示 异常 项目）
pause>nul
cls
echo            注 册 表 项 目                   状 态          修 复
echo = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
echo.
if "%vLockTaskbar%"=="异常" (echo. && echo          任务栏的修改锁定                   %vLockTaskbar%          %dvLockTaskbar%)
if "%vNoChangeStartMenu%"=="异常" (echo. && echo     “开始”菜单中的修改锁定                %vNoChangeStartMenu%          %dvNoChangeStartMenu%)
if "%vNoSetTaskbar%"=="异常" (echo. && echo         菜单设置修改锁定                    %vNoSetTaskbar%          %dvNoSetTaskbar%)
if "%vStartMenuLogOff%"=="异常" (echo. && echo    “开始”菜单中的“注销”项               %vStartMenuLogOff%          %dvStartMenuLogOff%)
if "%vNoRun%"=="异常" (echo. && echo     “开始”菜单中的“运行”项              %vNoRun%          %dvNoRun%)
if "%vNoFind%"=="异常" (echo. && echo    “开始”菜单中的“查找”项               %vNoFind%          %dvNoFind%)
if "%vNoSetFolders%"=="异常" (echo. && echo    “开始”菜单中的“设置”项               %vNoSetFolders%          %dvNoSetFolders%)
if "%vNoRecentDocsMenu%"=="异常" (echo. && echo  “开始”菜单中的“我最近的文档”项         %vNoRecentDocsMenu%          %dvNoRecentDocsMenu%)
if "%vNoSMHelp%"=="异常" (echo. && echo   “开始”菜单中的“帮助和支持”项          %vNoSMHelp%          %dvNoSMHelp%)
if "%vStart_ShowControlPanel%"=="异常" (echo. && echo    “开始”菜单中的“控制面板”项           %vStart_ShowControlPanel%          %dvStart_ShowControlPanel%)
if "%vStart_ShowMyComputer%"=="异常" (echo. && echo    “开始”菜单中的“我的电脑”项           %vStart_ShowMyComputer%          %dvStart_ShowMyComputer%)
if "%vNoSMMyDocs%"=="异常" (echo. && echo    “开始”菜单中的“我的文档”项           %vNoSMMyDocs%          %dvNoSMMyDocs%)
if "%vNoStartMenuMyMusic%"=="异常" (echo. && echo    “开始”菜单中的“我的音乐”项           %vNoStartMenuMyMusic%          %dvNoStartMenuMyMusic%)
if "%vNoSMMyPictures%"=="异常" (echo. && echo    “开始”菜单中的“我的图片”项           %vNoSMMyPictures%          %dvNoSMMyPictures%)
if "%vStart_ShowNetConn%"=="异常" (echo. && echo    “开始”菜单中的“网上邻居”项           %vStart_ShowNetConn%          %dvStart_ShowNetConn%)
if "%vNoStartMenuMorePrograms%"=="异常" (echo. && echo    “开始”菜单中的“所有程序”项           %vNoStartMenuMorePrograms%          %dvNoStartMenuMorePrograms%)
if "%vNoStartMenuMFUProgramsList%"=="异常" (echo. && echo    “开始”菜单中的“程序列表”项           %vNoStartMenuMFUProgramsList%          %dvNoStartMenuMFUProgramsList%)
if "%vNoPropertiesMyComputer%"=="异常" (echo. && echo    “我的电脑”右键“属性”                 %vNoPropertiesMyComputer%          %dvNoPropertiesMyComputer%)
if "%vNoManageMyComputerVerb%"=="异常" (echo. && echo    “我的电脑”右键“管理”                 %vNoManageMyComputerVerb%          %dvNoManageMyComputerVerb%)
if "%vNoPropertiesMyDocuments%"=="异常" (echo. && echo    “我的文档”右键“属性”                 %vNoPropertiesMyDocuments%          %dvNoPropertiesMyDocuments%)
if "%vNoInternetIcon%"=="异常" (echo. && echo             桌面IE图标                      %vNoInternetIcon%          %dvNoInternetIcon%)
if "%vNoShellSearchButton%"=="异常" (echo. && echo  “资源管理器”中的“搜索”按钮             %vNoShellSearchButton%          %dvNoShellSearchButton%)
if "%vNoTrayItemsDisplay%"=="异常" (echo. && echo           系统托盘图标                      %vNoTrayItemsDisplay%          %dvNoTrayItemsDisplay%)
if "%vHideClock%"=="异常" (echo. && echo          系统通知区域时钟                   %vHideClock%          %dvHideClock%)
if "%vNoWinKeys%"=="异常" (echo. && echo             WinKeys键                       %vNoWinKeys%          %dvNoWinKeys%)
if "%vNoViewContextMenu%"=="异常" (echo. && echo             桌面右键                        %vNoViewContextMenu%          %dvNoViewContextMenu%)
if "%vNoExpandedNewMenu%"=="异常" (echo. && echo     “文件”中的“新建”命令                %vNoExpandedNewMenu%          %dvNoExpandedNewMenu%)
if "%vNoBandCustomize%"=="异常" (echo. && echo    “查看”中的“工具栏”命令               %vNoBandCustomize%          %dvNoBandCustomize%)
if "%vNoDrives%"=="异常" (echo. &&echo              隐藏盘符                       %vNoDrives%          %dvNoDrives%)
if "%vNoviewondrive%"=="异常" (echo. &&echo            禁止访问盘符                     %vNoviewondrive%          %dvNoviewondrive%)
if "%vNoDispBackgroundPage%"=="异常" (echo. && echo         对话框中“背景”选项                %vNoDispBackgroundPage%          %dvNoDispBackgroundPage%)
if "%vNoDispAppearancePage%"=="异常" (echo. && echo         对话框中“外观”选项                %vNoDispAppearancePage%          %dvNoDispAppearancePage%)
if "%vNoDispSettingsPage%"=="异常" (echo. && echo         对话框中“设置”选项                %vNoDispSettingsPage%          %dvNoDispSettingsPage%)
if "%vNoDispScrSavPage%"=="异常" (echo. && echo       对话框中“屏幕保护”选项              %vNoDispScrSavPage%          %dvNoDispScrSavPage%)
if "%vGeneralTab%"=="异常" (echo. && echo   “Internet选项”中的“常规”项            %vGeneralTab%          %dvGeneralTab%)
if "%vSecurityTab%"=="异常" (echo. && echo   “Internet选项”中的“安全”项            %vSecurityTab%          %dvSecurityTab%)
if "%vPrivacyTab%"=="异常" (echo. && echo   “Internet选项”中的“隐私”项            %vPrivacyTab%          %dvPrivacyTab%)
if "%vContentTab%"=="异常" (echo. && echo   “Internet选项”中的“内容”项            %vContentTab%          %dvContentTab%)
if "%vConnectionsTab%"=="异常" (echo. && echo   “Internet选项”中的“连接”项            %vConnectionsTab%          %dvConnectionsTab%)
if "%vProgramsTab%"=="异常" (echo. && echo   “Internet选项”中的“程序”项            %vProgramsTab%          %dvProgramsTab%)
if "%vAdvancedTab%"=="异常" (echo. && echo   “Internet选项”中的“高级”项            %vAdvancedTab%          %dvAdvancedTab)
if "%vHomePage%"=="异常" (echo. && echo             IE首页锁定                      %vHomePage%          %dvHomePage%)
if "%vcache%"=="异常" (echo. && echo             IE临时文件                      %vcache%          %dvcache%)
if "%vsettings%"=="异常" (echo. && echo           IE“设置”按钮                    %vsettings%          %dvsettings%)
if "%vhistory%"=="异常" (echo. && echo       IE“清除历史纪录”按钮                %vhistory%          %dvhistory%)
if "%vcolour%"=="异常" (echo. && echo           IE“颜色”按钮                    %vcolour%          %dvcolour%)
if "%vfonts%"=="异常" (echo. && echo           IE“字体”按钮                    %vfonts%          %dvfonts%)
if "%vlanguages%"=="异常" (echo. && echo           IE“语言”按钮                    %vlanguages%          %dvlanguages%)
if "%vaccessibility%"=="异常" (echo. && echo          IE“辅助功能”按钮                 %vaccessibility%          %dvaccessibility%)
if "%vNoFileOpen%"=="异常" (echo. && echo     IE“文件”中的“打开”命令               %vNoFileOpen%          %dvNoFileOpen%)
if "%vNoBrowserClose%"=="异常" (echo. && echo     IE“文件”中的“关闭”命令               %vNoBrowserClose%          %dvNoBrowserClose%)
if "%vNoFileNew%"=="异常" (echo. && echo  IE“文件”中的“打开新窗口”命令            %vNoFileNew%          %dvNoFileNew%)
if "%vNoFileNew%"=="异常" (echo. && echo    IE“查看”中的“源文件”命令              %vNoFileNew%          %dvNoFileNew%)
if "%vNoTheaterMode%"=="异常" (echo. && echo   IE“查看”中的“全屏显示”命令             %vNoTheaterMode%          %dvNoTheaterMode%)
if "%vNoBrowserOptions%"=="异常" (echo. && echo  IE“工具”中的“Internet选项”命令               %vNoBrowserOptions%          %dvNoBrowserOptions%)
if "%vexe%"=="异常" (echo. && echo            exe文件关联                      %vexe%          %dvexe%)
if "%vbat%"=="异常" (echo. && echo            bat文件关联                      %vbat%          %dvbat%)
if "%vtxt%"=="异常" (echo. && echo            txt文件关联                      %vtxt%          %dvtxt%)
if "%vini%"=="异常" (echo. && echo            ini文件关联                      %vini%          %dvini%)
if "%vvbs%"=="异常" (echo. && echo            vbs文件关联                      %vvbs%          %dvvbs%)
if "%vcom%"=="异常" (echo. && echo            com文件关联                      %vcom%          %dvcom%)
echo.
echo = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
echo.
echo  统计   扫描：61 项      异常：%NO._Abnormal% 项     修复成功：%NO._Succeed% 项     修复失败：%NO._Fail% 项
echo.
echo.
echo                                 任意键返回主菜单
pause>nul
goto _max

:Virus_Immune
cls
Title 病毒免疫工具
set /a NO.=0
echo.
echo.
echo                    通过
echo.
echo         畸形文件夹  和  访问控制列表
echo.
echo             达到免疫病毒的作用
echo.
echo                任意键继续
pause>nul
::威金病毒
if exist "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT" del /f/s/q"%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT">nul 2>nul
md "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT\病毒免疫（威金病毒）"
md "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT、病毒免疫（威金病毒）" +S +R +H
cacls "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DAT\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DLL" del /f/s/q "C:\Program Files\Common Files\Microsoft Shared\MSInfo\06E3DD06.DLL">nul 2>nul
md "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DLL\病毒免疫（威金病毒）"
md "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DLL\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DLL\病毒免疫（威金病毒）" +S +R +H
cacls "%commonprogramfiles%\Microsoft Shared\MSInfo\06E3DD06.DLL\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%systemroot%\HELP\06E3DD06.CHM" del /f/s/q "%systemroot%\HELP\06E3DD06.CHM">nul 2>nul
md "%systemroot%\HELP\06E3DD06.CHM\病毒免疫（威金病毒）"
md "%systemroot%\HELP\06E3DD06.CHM\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%systemroot%\HELP\06E3DD06.CHM\病毒免疫（威金病毒）" +S +R +H
cacls "%systemroot%\HELP\06E3DD06.CHM\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%SystemRoot%\rundl132.exe" del /f/s/q "%SystemRoot%\rundl132.exe">nul 2>nul
md "%SystemRoot%\rundl132.exe\病毒免疫（威金病毒）"
md "%SystemRoot%\rundl132.exe\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%SystemRoot%\rundl132.exe\病毒免疫（威金病毒）" +S +R +H
cacls "%SystemRoot%\rundl132.exe\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%SystemRoot%\logo_1.exe" del /f/s/q "%SystemRoot%\logo_1.exe">nul 2>nul
md "%SystemRoot%\logo_1.exe\病毒免疫（威金病毒）"
md "%SystemRoot%\logo_1.exe\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%SystemRoot%\logo_1.exe\病毒免疫（威金病毒）" +S +R +H
cacls "%SystemRoot%\logo_1.exe\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%SystemRoot%\Sy.exe" del /f/s/q "%SystemRoot%\Sy.exe">nul 2>nul
md "%SystemRoot%\Sy.exe\病毒免疫（威金病毒）"
md "%SystemRoot%\Sy.exe\病毒免疫（威金病毒）\病毒免疫..\"
attrib "%SystemRoot%\Sy.exe\病毒免疫（威金病毒）" +S +R +H
cacls "%SystemRoot%\Sy.exe\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

for /l %%i in (0,1,9) do (
    if exist "%SystemRoot%\%%iSy.exe" del /f/s/q "%SystemRoot%\%%iSy.exe">nul 2>nul
    md "%SystemRoot%\%%iSy.exe\病毒免疫（威金病毒）"
    md "%SystemRoot%\%%iSy.exe\病毒免疫（威金病毒）\病毒免疫..\"
    attrib "%SystemRoot%\%%iSy.exe\病毒免疫（威金病毒）" +S +R +H
    cacls "%SystemRoot%\%%iSy.exe\病毒免疫（威金病毒）" /d everyone /e>nul 2>nul
    set /a NO.+=1
)



::Trojan-PSW.Win32.QQPass.vm病毒
if exist "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak" del /f/s/q "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak">nul 2>nul
md "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%programfiles%\Internet Explorer\PLUGINS\SystemKb.bak\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys" del /f/s/q "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys">nul 2>nul
md "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%programfiles%\Internet Explorer\PLUGINS\SystemKb.sys\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%programfiles%\Internet Explorer\PLUGINS\system2.jmp" del /f/s/q "%programfiles%\Internet Explorer\PLUGINS\system2.jmp">nul 2>nul
md "%programfiles%\Internet Explorer\PLUGINS\system2.jmp\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%programfiles%\Internet Explorer\PLUGINS\system2.jmp\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%programfiles%\Internet Explorer\PLUGINS\system2.jmp\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%programfiles%\Internet Explorer\PLUGINS\system2.jmp\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%WINDOWS%\intrenat.exe" del /f/s/q "%WINDOWS%\intrenat.exe">nul 2>nul
md "%WINDOWS%\intrenat.exe\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%WINDOWS%\intrenat.exe\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%WINDOWS%\intrenat.exe\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%WINDOWS%\intrenat.exe\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%SYSTEM%\WinSocks.dll" del /f/s/q "%SYSTEM%\WinSocks.dll">nul 2>nul
md "%SYSTEM%\WinSocks.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%SYSTEM%\WinSocks.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%SYSTEM%\WinSocks.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%SYSTEM%\WinSocks.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%WINDOWS%\exp1orer.dll" del /f/s/q "%WINDOWS%\exp1orer.dll">nul 2>nul
md "%WINDOWS%\exp1orer.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）"
md "%WINDOWS%\exp1orer.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）\病毒免疫..\"
attrib "%WINDOWS%\exp1orer.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" +S +R +H
cacls "%WINDOWS%\exp1orer.dll\病毒免疫（Trojan-PSW.Win32.QQPass.vm病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1



::超级木马下载器病毒Gameservet.exe
if exist "%temp%\RAVWM.exe" dle /f/s/q "%temp%\RAVWM.exe">nul 2>nul
md "%temp%\RAVWM.exe\病毒免疫（超级木马下载器病毒）"
md "%temp%\RAVWM.exe\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
attrib "%temp%\RAVWM.exe\病毒免疫（超级木马下载器病毒）" +S +R +H
cacls "%temp%\RAVWM.exe\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%temp%\qjso.exe" del /f/s/q "%temp%\qjso.exe">nul 2>nul
md "%temp%\qjso.exe\病毒免疫（超级木马下载器病毒）"
md "%temp%\qjso.exe\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
attrib "%temp%\qjso.exe\病毒免疫（超级木马下载器病毒）" +S +R +H
cacls "%temp%\qjso.exe\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%systemroot%\system32\8888-521ww.exe" del /f/s/q "%systemroot%\system32\8888-521ww.exe">nul 2>nul
md "%systemroot%\system32\8888-521ww.exe\病毒免疫（超级木马下载器病毒）"
md "%systemroot%\system32\8888-521ww.exe\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
attrib "%systemroot%\system32\8888-521ww.exe\病毒免疫（超级木马下载器病毒）" +S +R +H
cacls "%systemroot%\system32\8888-521ww.exe\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

for /l %%i in (0,1,9) do (
    if exist "%systemroot%\system32\game%%i.exe" del /f/s/q "%systemroot%\system32\game%%i.exe">nul 2>nul
    md "%systemroot%\system32\game%%i.exe\病毒免疫（超级木马下载器病毒）"
    md "%systemroot%\system32\game%%i.exe\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
    attrib "%systemroot%\system32\game%%i.exe\病毒免疫（超级木马下载器病毒）" +S +R +H
    cacls "%systemroot%\system32\game%%i.exe\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
    set /a NO.+=1
)

if exist "%systemroot%\system32\nwizqqfo.dll" del /f/s/q "%systemroot%\system32\nwizqqfo.dll">nul 2>nul
md "%systemroot%\system32\nwizqqfo.dll\病毒免疫（超级木马下载器病毒）"
md "%systemroot%\system32\nwizqqfo.dll\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
attrib "%systemroot%\system32\nwizqqfo.dll\病毒免疫（超级木马下载器病毒）" +S +R +H
cacls "%systemroot%\system32\nwizqqfo.dll\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1

if exist "%systemroot%\system32\gameservet.exe" del /f/s/q "%systemroot%\system32\gameservet.exe">nul 2>nul
md "%systemroot%\system32\gameservet.exe\病毒免疫（超级木马下载器病毒）"
md "%systemroot%\system32\gameservet.exe\病毒免疫（超级木马下载器病毒）\病毒免疫..\"
attrib "%systemroot%\system32\gameservet.exe\病毒免疫（超级木马下载器病毒）" +S +R +H
cacls "%systemroot%\system32\gameservet.exe\病毒免疫（超级木马下载器病毒）" /d everyone /e>nul 2>nul
set /a NO.+=1



::Trojan/Win32.IEprot.jdo病毒
for /l %%i in (0,1,9) do (
    if exist "%temp%\[%%i].gif" del /f/s/q "%temp%\[%%i].gif">nul 2>nul
    md "%temp%\[%%i].gif\病毒免疫（Trojan/Win32.IEprot病毒）"
    md "%temp%\[%%i].gif\病毒免疫（Trojan/Win32.IEprot病毒）\病毒免疫..\"
    attrib "%temp%\[%%i].gif\病毒免疫（Trojan/Win32.IEprot病毒）" +S +R +H
    cacls "%temp%\[%%i].gif\病毒免疫（Trojan/Win32.IEprot病毒）" /d everyone /e>nul 2>nul
    set /a NO.+=1
)



::Backdoor.Win32.Agent.ahj 
for /l %%i in (0,1,9) do (
    if exist "%temp%\db_%%i.exe" del /f /s/q "%temp%\db_%%i.exe"
    md "%temp%\db_%%i.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）"
    md "%temp%\db_%%i.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）\病毒免疫..\"
    attrib "%temp%\db_%%i.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" +S +R +H
    cacls "%temp%\db_%%i.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" /d everyone /e
    set /a NO.+=1
)

if exist "%system32%\92219FBE.DLL" del /f /s/q "%system32%\92219FBE.DLL"
md "%system32%\92219FBE.DLL\病毒免疫（Backdoor.Win32.Agent.ahj病毒）"
md "%system32%\92219FBE.DLL\病毒免疫（Backdoor.Win32.Agent.ahj病毒）\病毒免疫..\"
attrib "%system32%\92219FBE.DLL\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" +S +R +H
cacls "%system32%\92219FBE.DLL\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" /d everyone /e
set /a NO.+=1

if exist "%system32%\92219FBE.exe" del /f /s/q "%system32%\92219FBE.exe"
md "%system32%\92219FBE.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）"
md "%system32%\92219FBE.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）\病毒免疫..\"
attrib "%system32%\92219FBE.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" +S +R +H
cacls "%system32%\92219FBE.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" /d everyone /e
set /a NO.+=1

if exist "%system32%\92219FBET.exe" del /f /s/q "%system32%\92219FBET.exe"
md "%system32%\92219FBET.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）"
md "%system32%\92219FBET.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）\病毒免疫..\"
attrib "%system32%\92219FBET.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" +S +R +H
cacls "%system32%\92219FBET.exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" /d everyone /e
set /a NO.+=1

for /l %%i in (0,1,9) do (
    if exist "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe" del /f /s/q "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe"
    md "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）"
    md "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）\病毒免疫..\"
    attrib "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" +S +R +H
    cacls "%HOMEPATH%\Local Settings\Temporary Internet Files\Content.IE5\CHUFWD67\i[%%i].exe\病毒免疫（Backdoor.Win32.Agent.ahj病毒）" /d everyone /e
    set /a NO.+=1
)



::恶性U盘病毒
if exist "%Temp%\testexe.exe" del /f/s/q "%Temp%\testexe.exe"
md "%Temp%\testexe.exe\病毒免疫（恶性U盘病毒）"
md "%Temp%\testexe.exe\病毒免疫（恶性U盘病毒）\病毒免疫..\"
attrib "%Temp%\testexe.exe\病毒免疫（恶性U盘病毒）" +S +R +H
cacls "%Temp%\testexe.exe\病毒免疫（恶性U盘病毒）" /d everyone /e
set /a NO.+=1

if exist "%Temp%\testexe.dll" del /f/s/q "%Temp%\testexe.dll"
md "%Temp%\testexe.dll\病毒免疫（恶性U盘病毒）"
md "%Temp%\testexe.dll\病毒免疫（恶性U盘病毒）\病毒免疫..\"
attrib "%Temp%\testexe.dll\病毒免疫（恶性U盘病毒）" +S +R +H
cacls "%Temp%\testexe.dll\病毒免疫（恶性U盘病毒）" /d everyone /e
set /a NO.+=1



::woso.exe
if exist "%Temp%\woso.exe" del /f/s/q "%Temp%\woso.exe"
md "%Temp%\woso.exe\病毒免疫（woso.exe病毒）"
md "%Temp%\woso.exe\病毒免疫（woso.exe病毒）\病毒免疫..\"
attrib "%Temp%\woso.exe\病毒免疫（woso.exe病毒）" +S +R +H
cacls "%Temp%\woso.exe\病毒免疫（woso.exe病毒）" /d everyone /e
set /a NO.+=1

cls
echo.
echo = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
echo.
echo  统计   共免疫：%NO.% 病毒体
echo.
echo.
echo                                任意键返回主菜单
pause>nul
goto _max

:Repair_Safemode
cls
if exist safe.reg del /f/s/q safe.reg
echo Windows Registry Editor Version 5.00>>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot]>>safe.reg
echo "AlternateShell"="cmd.exe">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal]>>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\AppMgmt]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Base]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Boot Bus Extender]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Boot file system]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\CryptSvc]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\DcomLaunch]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\dmadmin]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\dmboot.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\dmio.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\dmload.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\dmserver]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\EventLog]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\File system]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Filter]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\HelpSvc]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Netlogon]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\PCI Configuration]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\PlugPlay]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\PNP Filter]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\Primary disk]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\RpcSs]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\SCSI Class]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\sermouse.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\sr.sys]>>safe.reg
echo @="FSFilter System Recovery">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\SRService]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\System Bus Extender]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\vga.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\vgasave.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\WinMgmt]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{36FC9E60-C465-11CF-8056-444553540000}]>>safe.reg
echo @="Universal Serial Bus controllers">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E965-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="CD-ROM Drive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E967-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="DiskDrive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E969-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Standard floppy disk controller">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E96A-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Hdc">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E96B-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Keyboard">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E96F-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Mouse">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E977-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="PCMCIA Adapters">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E97B-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="SCSIAdapter">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E97D-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="System">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{4D36E980-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Floppy disk drive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{71A27CDD-812A-11D0-BEC7-08002BE2092F}]>>safe.reg
echo @="Volume">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\{745A17A0-74D3-11D0-B6FE-00A0C90F57DA}]>>safe.reg
echo @="Human Interface Devices">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network]>>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\AFD]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\AppMgmt]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Base]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Boot Bus Extender]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Boot file system]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Browser]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\CryptSvc]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\DcomLaunch]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Dhcp]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\dmadmin]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\dmboot.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\dmio.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\dmload.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\dmserver]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\DnsCache]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\EventLog]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\File system]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Filter]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\HelpSvc]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\ip6fw.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\ipnat.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\LanmanServer]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\LanmanWorkstation]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\LmHosts]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Messenger]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NDIS]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NDIS Wrapper]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Ndisuio]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetBIOS]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetBIOSGroup]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetBT]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetDDEGroup]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Netlogon]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetMan]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Network]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NetworkProvider]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\NtLmSsp]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\PCI Configuration]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\PlugPlay]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\PNP Filter]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\PNP_TDI]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Primary disk]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpcdd.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpdd.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpwd.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdsessmgr]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\RpcSs]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\SCSI Class]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\sermouse.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\SharedAccess]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\sr.sys]>>safe.reg
echo @="FSFilter System Recovery">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\SRService]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Streams Drivers]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\System Bus Extender]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\Tcpip]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\TDI]>>safe.reg
echo @="Driver Group">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\tdpipe.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\tdtcp.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\termservice]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\vga.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\vgasave.sys]>>safe.reg
echo @="Driver">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\WinMgmt]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\WZCSVC]>>safe.reg
echo @="Service">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{36FC9E60-C465-11CF-8056-444553540000}]>>safe.reg
echo @="Universal Serial Bus controllers">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E965-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="CD-ROM Drive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E967-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="DiskDrive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E969-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Standard floppy disk controller">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E96A-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Hdc">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E96B-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Keyboard">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E96F-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Mouse">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E972-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Net">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E973-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="NetClient">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E974-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="NetService">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E975-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="NetTrans">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E977-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="PCMCIA Adapters">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E97B-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="SCSIAdapter">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E97D-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="System">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{4D36E980-E325-11CE-BFC1-08002BE10318}]>>safe.reg
echo @="Floppy disk drive">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{71A27CDD-812A-11D0-BEC7-08002BE2092F}]>>safe.reg
echo @="Volume">>safe.reg

echo.>>safe.reg&&echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Network\{745A17A0-74D3-11D0-B6FE-00A0C90F57DA}]>>safe.reg
echo @="Human Interface Devices">>safe.reg
regedit.exe/s safe.reg
del /f/s/q safe.reg>nul
echo.
echo.
echo.
echo      系统安全模式修复完成
echo.
echo.
echo       任意键返回主菜单
pause>nul
goto _max

:U_Repair
cls
Mode con cols=70 lines=25
Title U盘修复
set Drive_U=未知
for /f %%a in ('wmic logicaldisk where "drivetype='2'" get DeviceID ^|findstr :') do set Drive_U=%%a
echo;
echo;
echo   说明： 处理 autorun.inf 启动类U盘病毒导致的
echo             .exe和.lnk同名文件和文件夹恶意隐藏等问题 
echo;
echo;
echo;
echo 自动检测可移动磁盘： %Drive_U%
echo;
echo;
echo;
echo        A.修复%Drive_U%
echo;
echo        B.修复其他驱动器
echo;
echo        Q.返回主菜单
echo;
set /p choose=请选择：
if /I %choose%==a goto DriveU_Repair_Do
if /I %choose%==b goto DriveU_Repair_Defined
if /I %choose%==q goto _max
goto DriveU_Repair



:DriveU_Repair_Defined
cls
echo;
echo;
echo;
echo  请输入需要修复的盘符，例如：  H: I: J:
echo;
set /p Drive_U=
if not exist %Drive_U% (
    echo;
    echo;
    echo                 没有检测到可移动磁盘，请重试
    ping /n 3 127.1>nul
    goto DriveU_Repair_Defined
)



:DriveU_Repair_Do
attrib -h -s -r %Drive_U%\autorun.inf>nul 2>nul
if exist "%Drive_U%\autorun.inf" (
    echo → 发现autorun.inf启动文件
    echo;
    for /f "tokens=1,2,3 delims== " %%i in (%Drive_U%\autorun.inf) do (
        if "%%i" equ "Shellexecute" (
            echo → 发现启动指向病毒体：
            echo;
            echo %%j
            if %%k neq "" echo %%k
            echo;
            if exist %%j del /f /s /q %%j
            if %%k neq "" (
                if exist %%j del /f /s /q %%k
            )
        echo;
        echo √ 病毒体删除完成
        )
    )
) else (
    echo;
    echo √ 未发现 autorun.inf 病毒启动文件
)
for /f "delims=" %%i in ('dir /ad /b %Drive_U%') do (
    if exist "%Drive_U%\%%i.lnk" (
        echo;
        echo → 发现快捷方式病毒（*.lnk）。
        echo;
        echo √ 删除......
        del / f /q /s "%Drive_U%\%%i.lnk" >nul 2>nul
    )
    if exist "%Drive_U%\%%i.exe" (
        echo;
        echo → 发现exe病毒（*.exe）。
        echo;
        echo √ 删除......
        del / f /q /s "%Drive_U%\%%i.exe" >nul 2>nul
    )
    for /f "delims= " %%h in ('attrib "%Drive_U%\%%i"') do (
        if %%h==H (
            echo;
            echo → 恢复文件夹：%%i      正常属性
            attrib -h -s -r "%Drive_U%\%%i"
        )
    )
)
echo;
echo √ 文件夹属性恢复完成
echo;
echo;
echo     所有修复已经完成，请检查......
ping /n 5 127.1>nul
goto _max

:dstxq
title 定时提醒器
set xiangs=
set /p xiangs=请输入什么时候响（格式：20:58:00）:
start /min "" %0 %xiangs%
exit
:long
title 定时提醒器正在运行……
:ma
if '%1'=='%time:~0,2%:%time:~3,2%:%time:~6,2%' goto nlxx
goto ma
:nlxx
title 闹铃响了！！！！！！
:xiang
echo 
goto xiang

:_m3
echo           现在时间：%date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒
echo                     ╔════════╗
if '%PROCESSOR_ARCHITECTURE%'=='x86' echo                     ║正在使用32位系统║
if '%PROCESSOR_ARCHITECTURE%'=='AMD64' echo                     ║正在使用64位系统║
echo                     ╚════════╝
echo                        ╔═════╗
echo                        ║批处理工具║
echo  ╔══════════╩══╦══╩══════════╗
echo  ║ 1、聊天机器人            ║                          ║
echo  ╠═════════════╩═════════════╣
echo  ║                   back、上一页                       ║
echo  ╚═══════════════════════════╝
set chi=
set /p chi=  请选择操作后回车:
if '%chi%'=='' goto _m3
if '%chi%'=='1' goto ltjqr
if '%chi%'=='back' goto _m1
goto _m3


:ltjqr
color f0
mode con: cols=62 lines=200
title 聊天机器人
:mai
echo %date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒  聊天机器人>%windir%\dh.txt
echo 您好，我是聊天机器人，输入help查看帮助 >>%windir%\dh.txt
echo. >>%windir%\dh.txt
:_lt
cls
type %windir%\dh.txt
echo ═══════════════════════════════
set shy=
set dns=
set dnz=
set /p shy=请输入你的话后回车:
if '%shy%'=='' goto _m1
echo %date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒  我 >>%windir%\dh.txt
echo %shy% >>%windir%\dh.txt
echo. >>%windir%\dh.txt
set dns=对不起，我没明白您的意思，请输入help查看帮助
call :dnshb

echo %date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒  聊天机器人>>%windir%\dh.txt
echo %dns% >>%windir%\dh.txt
echo. >>%windir%\dh.txt
if /i '%dnz%'=='' goto fh
start "" %dnz%
:fh
goto _lt

:helpj
echo %date% %time:~0,2%点%time:~3,2%分%time:~6,2%秒  聊天机器人>>%windir%\dh.txt
echo 帮助： >>%windir%\dh.txt
echo 输入： >>%windir%\dh.txt
echo exit：退出 >>%windir%\dh.txt
echo 刷屏：清空屏幕>>%windir%\dh.txt
echo 我的主人： >>%windir%\dh.txt
echo Mayx >>%windir%\dh.txt
echo. >>%windir%\dh.txt
goto _lt

:dnshb
if /i '%shy%'=='help' goto helpj
if /i '%shy%'=='刷屏' goto mai
if /i '%shy%'=='exit' goto _max
if /i '%shy%'=='ai学习机' goto aixx
::在这里加入新的命令
```

  **注：因为隐私原因，部分代码稍作修改**   
  当然，这个程序有不少地方是抄的，而且很烂……（毕竟是小时候写的嘛）   
  
## Linux Shell时期
  因为手机（Android）系统基于Linux，所以我开始[学习Linux Shell](http://c.biancheng.net/cpp/shell/)（没错，当时就是在这个网站上学的），
  以前用批处理学写工具箱的习惯当然也继承到了学写Linux Shell上，在Linux上写的工具箱的名字叫做myx，代码如下：   
  
<script> 
    function showcode2() {  
    $('.showbutton2').toggle(); 
    $('.language-shell').toggle(); 
    } 
</script> 
<button onclick="showcode2()" class="showbutton2">Show Code</button> 
<button onclick="showcode2()" class="showbutton2" style="display:none;">Hide Code</button>

```shell
#!/system/bin/sh
root="`id`"
case $root in
uid=0* )
;;
*)
echo Please root first
exit
;;
esac
if busybox [ -e /system/bin/clear ]
then
break
else
echo Please install busybox first.
exit
fi
until cat /data/mjump
do
clear 
echo "Enter the keys:"
read pass
rps="$((`date +%H%m`*`date +%d`))"
case $pass in
$rps)
echo " ">/data/mjump
;;
*)
echo 'Error!'
sleep 2
;;
esac
done
clear 
echo "Welcome to use myx program..."
sleep 2
while
do
clear
echo "Today is `date` "
echo "This system is `uname` `uname -r`"
echo "This is my first Shell."
echo "0.exit          1-3.watch my composition"
echo "4.book reader   5.shutdown    6.notebook"
echo "7.calculate average         8.calculator"
echo "9.call or send SMS   a.install a package"
echo "b.lock screen   c.make a seed of picture"
echo "d.start talk AI beta     e.backup system"
echo "f.start telnet server g.start web server"
echo "h.start ftp server     i.make a vcf file"
echo "j.make random        k.make a goods list"
echo "              next.next page"
echo 'Input a number or letter between 0 to k:' 
read s
case $s in
0)
echo "Thanks used my Shell."
break
;;
1)
clear
echo "Hi,I m the phone's master."
echo "My name is Mayx."
echo "I like to play computer,"
echo "so I want to be a computer programmer."
echo "I want to write a system like the Android,"
echo "then I must \"good good study,day day up\"."
sleep 10
;;
2)
clear
echo "My father is Mayx Father."
echo "And my mother is Mayx Mather."
echo "I love them."
sleep 5
;;
3)
clear 
echo "I think Shell is a good program language."
echo "Of course!batch is a good program language,too."
echo "C++ is good,but it is difficult." 
sleep 10 
;;
4)
clear
echo "Write the book path:" 
read bopa
more $bopa
sleep 1
;;
5)
reboot -p
;;
6)
clear 
echo "Save to:" 
read satx
echo >$satx
while
do
clear
echo "Input exit to exit"
cat $satx
echo "Input:"
read intx
case $intx in
exit)
break 1
;;
*)
echo "$intx" >> "$satx"
;;
esac
done
echo OK!
sleep 2
;;
7)
clear
SCORE="0"
AVERAGE="0"
SUM="0"
NUM="0"
while
do
echo "Enter your $(($NUM+1)) number('q' for calculate): "
read SCORE
if [ "$SCORE" == "q" ]
then
echo "Average rating: $AVERAGE."
sleep 5 
break 1
else
SUM=$(($SUM+$SCORE))
NUM=$(($NUM+1))
AVERAGE=$(($SUM/$NUM))
fi
done
;;
8)
clear 
echo "Write your equation:"
read ss
echo "${ss}=$((${ss})) "
sleep 5
;;
9)
clear 
echo " Your phone number:"
read sdt
echo "Your phone number is $sdt"
echo "Input 1 to call"
echo "Input 2 to send SMS"
echo 'Input a number between 1 to 2:' 
read ab
case $ab in
1)
service call phone 2 s16 $sdt
;;
2)
am start -a android.intent.action.SENDTO -d sms:$sdt --ez exit_on_sent true 
;;
*)
echo "Error!"
sleep 2
;; 
esac
;;
a)
clear
echo "Write the package path:"
read pp
pm install "$pp"
;;
b)
input keyevent 26
;;
c)
clear
echo "Write the cabinet path:"
read cab
echo " Write the picture path:"
read pic
cat $cab >> $pic
echo 'OK!'
sleep 1
;;
d)
echo "Welcome to use talk AI" >/cache/talk.txt 
ais="Hello,I'm talk AI."
while
do
echo "`date` AI" >>/cache/talk.txt
echo "$ais" >>/cache/talk.txt
echo " ">>/cache/talk.txt
clear
cat /cache/talk.txt
echo "----------------------------"
echo 'You say:'
read say
echo "`date` You" >>/cache/talk.txt
echo "$say" >>/cache/talk.txt
echo " " >>/cache/talk.txt
case $say in
bye)
break 1
;;
*)
ais="Sorry,I don't know what do you say."
;;
esac
done 
;;
e)
clear
echo "Please wait......"
dd if=/dev/block/mtdblock11 of=/sdcard/system.img
echo 'OK!'
sleep 1
;;
f)
telnetd -l /system/bin/sh
echo OK! 
sleep 1
;;
g)
httpd -h /mnt/My-space/ 
echo OK!
sleep 1
;;
h)
clear
tcpsvd -vE 0.0.0.0 21 ftpd -w /
;;
i)
clear
echo "Write the name:"
read nam
echo "Write the phone number:"
read num
echo "Write the save path:"
read vcs
echo "BEGIN:VCARD" >$vcs/$nam.vcf
echo "VERSION:2.1" >>$vcs/$nam.vcf 
echo "N:$nam;" >>$vcs/$nam.vcf 
echo "FN:$nam" >>$vcs/$nam.vcf 
echo "TEL;CELL;VOICE:$num" >>$vcs/$nam.vcf 
echo "END:VCARD" >>$vcs/$nam.vcf 
echo "Saved to $vcs/$nam.vcf"
sleep 1
;;
j)
clear
while
do
cat /proc/sys/kernel/random/uuid | awk -F- '{printf("%s ",$1)}'
sleep 1
done
;;
k)
clear
coln(){
echo "Input Unit-price:"
read unit
echo "Input Quantity:"
read quty
lisn="$((${lisn}+1))"
toal="$((${unit}*${quty}))"
ttal="$((${ttal}+${toal}))"
}
lisn="0"
ttal="0" 
echo "Save to:"
read sals
echo "Save for [1.txt 2.csv]:"
read bcfs
case $bcfs in
1)
echo "Goods list">$sals
echo "Num    Goods    Unit-price    Quantity    Total" >>$sals 
echo "-----------------------------------">>$sals 
while
do
clear
cat $sals 
echo "Input Goods(Input exit to save):"
read gods
case $gods in
exit)
echo "-----------------------------------">>$sals
echo "Total:$ttal" >>$sals 
echo "OK!"
sleep 1
break 1
;;
*)
coln
echo "$lisn    $gods          $unit          $quty          $toal" >>$sals
;;
esac
done
;;
2)
echo "Goods list">$sals
echo "Num,Goods,Unit-price,Quantity,Total" >>$sals 
while
do
clear
cat $sals | awk -F, '{printf("%s     %s     %s     %s     %s\n", $1, $2, $3, $4, $5)}'
echo "-----------------------------------" 
echo "Input Goods(Input exit to save):"
read gods
case $gods in
exit)
echo "Total,$ttal" >>$sals 
echo "OK!"
sleep 1
break 1
;;
*)
coln
echo "$lisn,$gods,$unit,$quty,$toal" >>$sals 
;;
esac 
done
;;
esac
;;
next)
while
do
clear
echo "Today is `date` "
echo "This system is `uname` `uname -r`"
echo "This is my first Shell." 
echo "1.block website           2.find process" 
echo "3.systeminfo                4.play music"
echo "5.subnet ip scanner         6.phone test"
echo "           back.back to main"
echo 'Input a number or letter between 1 to 6:' 
read st
case $st in
1)
clear
echo "input a domain:"
read domn
echo "127.0.0.1 $domn">>/etc/hosts
echo "OK!"
sleep 1
;;
2)
clear
echo "Input process or pid:"
read pgd
ps | grep $pgd
sleep 10
;;
3)
while
do
clear
cat /proc/loadavg | awk '{printf("Cpu:%s\n",$1)}'
cat /proc/meminfo | grep MemTotal:
cat /proc/meminfo | grep MemFree:
df | grep /mnt/sdcard | awk '{printf("Diskfree:%sKB/%sKB",$1,$2)}'
sleep 1
done
;;
4)
clear
cd /sdcard/
find -name *.mp3
echo "Input the music name:"
read mus
fms=`find -name *.mp3 | grep $mus`
am start -n com.android.music/com.android.music.MediaPlaybackActivity -d /sdcard${fms#*.}
;;
5)
clear
echo "Input subnet:"
read snt
echo "Start for:"
read ip
while [ $ip != "254" ]; 
do 
busybox ping ${snt}.$ip -c 2 -w 2 | grep -q "ttl=" && echo "${snt}.$ip yes" || echo "${snt}.$ip no"
ip=$(($ip+1))
done 
;;
6)
clear
if [ -e /sdcard/score ]
then
echo "last score:`wc -m /sdcard/score |awk '{printf("%s",$1)}'`"
fi
echo "Warning!!"
echo "If you start test,you can't to stop"
read nu
echo "">/sdcard/score
testb(){
echo "0">>/sdcard/score
testb | testb
};testb
;;
back)
break 1
;;
*)
echo "Error!"
sleep 2
;;
esac
done
;; 
*)
echo "Error!"
sleep 2
;;
esac
done
```

  **注：因为隐私原因，部分代码稍作修改**   
  
  在学习Shell期间，我了解了一个很神奇的论坛，叫做Telnet BBS，貌似过去的高校会建这个东西。我学了Shell后
  感觉做BBS貌似很简单，于是开了一个远古巨坑：[MaBBS](https://github.com/Mabbs/Mabbs)，这也就是为什么我的Github叫做Mabbs。   
  这个东西写的我好苦啊，感觉这辈子都被这个项目给破坏了……（都是我的错QAQ）   

# 云阶段
## 虚拟空间时期
  我接触网站的时候是从3V免费空间开始的（这个空间是真的垃圾，连PHP都不支持……），当时用的还是FrontPage，给自己写了一个主页，给当时的初中写了一个主页，后来这个烂空间不知为什么，把所有数据都清空了。   
  再往后，我遇见了主机壳虚拟空间，发现这个虚拟空间有BUG，可以往自己账户里打钱，于是靠着这个，试着搭建了一个MediaWiki。还买了一个域名，叫：mayx.moe   
  当然后来被发现就被封号了……
  近来我发现了不少免费的虚拟空间，比如byethost,000webhost……它们都支持PHP，但是访问速度超级慢，不过Gearhost还不错，就是空间小，偶尔会503……   
  后来遇见了[花火学园](https://www.say-huahuo.com/)，才让我真正的明白了什么是建网站……   

## 云主机时期
  当时花火学园有个小漏洞，于是我向网站管理员[you06](https://www.say-huahuo.com/home.php?mod=space&uid=17139)反馈了这个漏洞，然后you06邀请我加入花火学园的维护，于是我很高兴的接受了。   
  在遇到花火学园之前，我根本不知道云主机是什么东西，以为网站都是用FTP上传的，后来搜了以下，才知道原来云主机需要SSH连接的。   
  这时候，我的老师正好委托我做网站，我才真正的在**服务器**上建了网站。   
  在这期间，我了解了不少关于服务器的知识，包括git在内，这使我做出了[Mayx日报](https://mayx.tk/)系统。   
  后来you06由于某些原因不能维护花火学园了，于是我成为了花火学园第三代程序员。   
  自此，我才有了真正属于我的服务器。对此，我相当感谢[Say花火](http://tieba.baidu.com/home/main/?un=Say%E8%8A%B1%E7%81%AB)大佬。（不仅如此，我也因此收到了第一个来自网络的礼物：一个抱枕）。

# 结尾
   我在计算机上的发展，离不开网络上各种资源的帮助，对此，我感到十分感激。希望有一天，我也能为这个互联网做出一些贡献。
   
   
